<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Глава 14 Геостатистика | Визуализация и анализ географических данных на языке R</title>
  <meta name="description" content="Курс лекций, посвященных использованию языка программирования R для визуализации и анализа географических данных" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Глава 14 Геостатистика | Визуализация и анализ географических данных на языке R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Курс лекций, посвященных использованию языка программирования R для визуализации и анализа географических данных" />
  <meta name="github-repo" content="tsamsonov/r-geo-course" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Глава 14 Геостатистика | Визуализация и анализ географических данных на языке R" />
  
  <meta name="twitter:description" content="Курс лекций, посвященных использованию языка программирования R для визуализации и анализа географических данных" />
  

<meta name="author" content="Тимофей Самсонов" />


<meta name="date" content="2020-11-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="interpolation-deterministic.html"/>
<link rel="next" href="autocorrelation.html"/>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block/empty-anchor.js"></script>
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding/datatables.js"></script>
<link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk/js/crosstalk.min.js"></script>
<link href="libs/leaflet/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet/leaflet.js"></script>
<link href="libs/leafletfix/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding/leaflet.js"></script>
<script src="libs/leaflet-providers/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin/leaflet-providers-plugin.js"></script>
<script src="libs/FlatGeoBuf/fgb.js"></script>
<script src="libs/FlatGeoBuf/flatgeobuf-geojson.min.js"></script>
<script src="libs/chromajs/chroma.min.js"></script>
<link id="sf_stations-1-attachment" rel="attachment" href="libs/sf_stations/sf_stations_layer.fgb"/>
<link href="libs/HomeButton/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton/home-button.js"></script>
<script src="libs/HomeButton/easy-button-src.min.js"></script>
<script src="libs/clipboard/setClipboardText.js"></script>
<link href="libs/mapviewCSS/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS/mapview.css" rel="stylesheet" />
<link id="countries-1-attachment" rel="attachment" href="libs/countries/countries_layer.fgb"/>
<script src="libs/plotly-binding/plotly.js"></script>
<script src="libs/typedarray/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main/plotly-latest.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Визуализация и анализ географических данных на языке R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Введение</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#программное-обеспечение"><i class="fa fa-check"></i>Программное обеспечение</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#установка-и-подключение-пакетов"><i class="fa fa-check"></i>Установка и подключение пакетов</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#выполнение-программного-кода"><i class="fa fa-check"></i>Выполнение программного кода</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#установка-рабочей-директории"><i class="fa fa-check"></i>Установка рабочей директории</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#диагностические-функции"><i class="fa fa-check"></i>Диагностические функции</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#получение-справки"><i class="fa fa-check"></i>Получение справки</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#комментарии"><i class="fa fa-check"></i>Комментарии</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#стандарт-оформления-кода-на-r"><i class="fa fa-check"></i>Стандарт оформления кода на R</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#зарезервированные-слова"><i class="fa fa-check"></i>Зарезервированные слова</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#названия-переменных"><i class="fa fa-check"></i>Названия переменных</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#названия-специальных-символов"><i class="fa fa-check"></i>Названия специальных символов</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#управляющие-последовательности"><i class="fa fa-check"></i>Управляющие последовательности</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ссылка-на-пособие"><i class="fa fa-check"></i>Ссылка на пособие</a></li>
</ul></li>
<li class="part"><span><b>I Основы языка R</b></span></li>
<li class="chapter" data-level="1" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>1</b> Типы данных, условия, ввод и вывод</a><ul>
<li class="chapter" data-level="1.1" data-path="data-types.html"><a href="data-types.html#data_types"><i class="fa fa-check"></i><b>1.1</b> Типы данных</a><ul>
<li class="chapter" data-level="1.1.1" data-path="data-types.html"><a href="data-types.html#numbers"><i class="fa fa-check"></i><b>1.1.1</b> Числа</a></li>
<li class="chapter" data-level="1.1.2" data-path="data-types.html"><a href="data-types.html#strings"><i class="fa fa-check"></i><b>1.1.2</b> Строки</a></li>
<li class="chapter" data-level="1.1.3" data-path="data-types.html"><a href="data-types.html#dates"><i class="fa fa-check"></i><b>1.1.3</b> Даты и длительности</a></li>
<li class="chapter" data-level="1.1.4" data-path="data-types.html"><a href="data-types.html#times"><i class="fa fa-check"></i><b>1.1.4</b> Время и периоды</a></li>
<li class="chapter" data-level="1.1.5" data-path="data-types.html"><a href="data-types.html#booleans"><i class="fa fa-check"></i><b>1.1.5</b> Логические</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="data-types.html"><a href="data-types.html#manipulations"><i class="fa fa-check"></i><b>1.2</b> Манипуляции с типами</a><ul>
<li class="chapter" data-level="1.2.1" data-path="data-types.html"><a href="data-types.html#determine_data_type"><i class="fa fa-check"></i><b>1.2.1</b> Определение типа данных</a></li>
<li class="chapter" data-level="1.2.2" data-path="data-types.html"><a href="data-types.html#conversion"><i class="fa fa-check"></i><b>1.2.2</b> Преобразование типов данных</a></li>
<li class="chapter" data-level="1.2.3" data-path="data-types.html"><a href="data-types.html#check_types"><i class="fa fa-check"></i><b>1.2.3</b> Проверка типов данных и пустых значений</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="data-types.html"><a href="data-types.html#read_write_console"><i class="fa fa-check"></i><b>1.3</b> Ввод и вывод данных в консоли</a><ul>
<li class="chapter" data-level="1.3.1" data-path="data-types.html"><a href="data-types.html#read_console"><i class="fa fa-check"></i><b>1.3.1</b> Ввод данных</a></li>
<li class="chapter" data-level="1.3.2" data-path="data-types.html"><a href="data-types.html#write_console"><i class="fa fa-check"></i><b>1.3.2</b> Вывод данных</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="data-types.html"><a href="data-types.html#ifelse"><i class="fa fa-check"></i><b>1.4</b> Условный оператор</a></li>
<li class="chapter" data-level="1.5" data-path="data-types.html"><a href="data-types.html#switch"><i class="fa fa-check"></i><b>1.5</b> Оператор переключения</a></li>
<li class="chapter" data-level="1.6" data-path="data-types.html"><a href="data-types.html#stop"><i class="fa fa-check"></i><b>1.6</b> Прерывание программы</a></li>
<li class="chapter" data-level="1.7" data-path="data-types.html"><a href="data-types.html#basics-detail"><i class="fa fa-check"></i><b>1.7</b> Технические детали</a></li>
<li class="chapter" data-level="1.8" data-path="data-types.html"><a href="data-types.html#review"><i class="fa fa-check"></i><b>1.8</b> Краткий обзор</a></li>
<li class="chapter" data-level="1.9" data-path="data-types.html"><a href="data-types.html#questions_tasks_basics"><i class="fa fa-check"></i><b>1.9</b> Контрольные вопросы и упражнения</a><ul>
<li class="chapter" data-level="1.9.1" data-path="data-types.html"><a href="data-types.html#questions_basics"><i class="fa fa-check"></i><b>1.9.1</b> Вопросы</a></li>
<li class="chapter" data-level="1.9.2" data-path="data-types.html"><a href="data-types.html#tasks_basic"><i class="fa fa-check"></i><b>1.9.2</b> Упражнения</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>2</b> Структуры данных и циклы</a><ul>
<li class="chapter" data-level="2.1" data-path="data-structures.html"><a href="data-structures.html#data_structures_homo"><i class="fa fa-check"></i><b>2.1</b> Однородные структуры данных</a><ul>
<li class="chapter" data-level="2.1.1" data-path="data-structures.html"><a href="data-structures.html#vectors"><i class="fa fa-check"></i><b>2.1.1</b> Векторы</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-structures.html"><a href="data-structures.html#matrices"><i class="fa fa-check"></i><b>2.1.2</b> Матрицы</a></li>
<li class="chapter" data-level="2.1.3" data-path="data-structures.html"><a href="data-structures.html#arrays"><i class="fa fa-check"></i><b>2.1.3</b> Массивы</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-structures.html"><a href="data-structures.html#heterogeneous"><i class="fa fa-check"></i><b>2.2</b> Разнородные структуры данных</a><ul>
<li class="chapter" data-level="2.2.1" data-path="data-structures.html"><a href="data-structures.html#data_frames"><i class="fa fa-check"></i><b>2.2.1</b> Фреймы данных</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-structures.html"><a href="data-structures.html#lists"><i class="fa fa-check"></i><b>2.2.2</b> Списки</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-structures.html"><a href="data-structures.html#factors"><i class="fa fa-check"></i><b>2.3</b> Факторы</a></li>
<li class="chapter" data-level="2.4" data-path="data-structures.html"><a href="data-structures.html#vector_desc"><i class="fa fa-check"></i><b>2.4</b> Описание структуры данных</a></li>
<li class="chapter" data-level="2.5" data-path="data-structures.html"><a href="data-structures.html#cycles"><i class="fa fa-check"></i><b>2.5</b> Циклы</a></li>
<li class="chapter" data-level="2.6" data-path="data-structures.html"><a href="data-structures.html#structures-detail"><i class="fa fa-check"></i><b>2.6</b> Технические детали</a></li>
<li class="chapter" data-level="2.7" data-path="data-structures.html"><a href="data-structures.html#review_structures"><i class="fa fa-check"></i><b>2.7</b> Краткий обзор</a></li>
<li class="chapter" data-level="2.8" data-path="data-structures.html"><a href="data-structures.html#questions_tasks_vectors"><i class="fa fa-check"></i><b>2.8</b> Контрольные вопросы и упражнения</a><ul>
<li class="chapter" data-level="2.8.1" data-path="data-structures.html"><a href="data-structures.html#questions_vectors"><i class="fa fa-check"></i><b>2.8.1</b> Вопросы</a></li>
<li class="chapter" data-level="2.8.2" data-path="data-structures.html"><a href="data-structures.html#tasks_vectors"><i class="fa fa-check"></i><b>2.8.2</b> Упражнения</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tables.html"><a href="tables.html"><i class="fa fa-check"></i><b>3</b> Табличные данные</a><ul>
<li class="chapter" data-level="3.1" data-path="tables.html"><a href="tables.html#tables_prerequisites"><i class="fa fa-check"></i><b>3.1</b> Предварительные требования</a></li>
<li class="chapter" data-level="3.2" data-path="tables.html"><a href="tables.html#tables_datastructures"><i class="fa fa-check"></i><b>3.2</b> Структуры данных</a></li>
<li class="chapter" data-level="3.3" data-path="tables.html"><a href="tables.html#tables_reading"><i class="fa fa-check"></i><b>3.3</b> Чтение</a><ul>
<li class="chapter" data-level="3.3.1" data-path="tables.html"><a href="tables.html#tables_reading_inner"><i class="fa fa-check"></i><b>3.3.1</b> Встроенные данные</a></li>
<li class="chapter" data-level="3.3.2" data-path="tables.html"><a href="tables.html#tables_reading_text"><i class="fa fa-check"></i><b>3.3.2</b> Текстовые таблицы</a></li>
<li class="chapter" data-level="3.3.3" data-path="tables.html"><a href="tables.html#tables_reading_excel"><i class="fa fa-check"></i><b>3.3.3</b> Таблицы Microsoft Excel</a></li>
<li class="chapter" data-level="3.3.4" data-path="tables.html"><a href="tables.html#tables_reading_params"><i class="fa fa-check"></i><b>3.3.4</b> Параметры</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="tables.html"><a href="tables.html#tables_view"><i class="fa fa-check"></i><b>3.4</b> Просмотр</a></li>
<li class="chapter" data-level="3.5" data-path="tables.html"><a href="tables.html#tables_elements"><i class="fa fa-check"></i><b>3.5</b> Столбцы, строки и ячейки</a><ul>
<li class="chapter" data-level="3.5.1" data-path="tables.html"><a href="tables.html#tables_elements_names"><i class="fa fa-check"></i><b>3.5.1</b> Названия</a></li>
<li class="chapter" data-level="3.5.2" data-path="tables.html"><a href="tables.html#tables_elements_columns"><i class="fa fa-check"></i><b>3.5.2</b> Обращение к столбцам</a></li>
<li class="chapter" data-level="3.5.3" data-path="tables.html"><a href="tables.html#tables_elements_rows"><i class="fa fa-check"></i><b>3.5.3</b> Обращение к строкам</a></li>
<li class="chapter" data-level="3.5.4" data-path="tables.html"><a href="tables.html#tables_elements_cells"><i class="fa fa-check"></i><b>3.5.4</b> Обращение к ячейкам</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="tables.html"><a href="tables.html#tables_manipuilations"><i class="fa fa-check"></i><b>3.6</b> Преобразования</a><ul>
<li class="chapter" data-level="3.6.1" data-path="tables.html"><a href="tables.html#tables_manipiulations_grammar"><i class="fa fa-check"></i><b>3.6.1</b> Грамматика манипуляций</a></li>
<li class="chapter" data-level="3.6.2" data-path="tables.html"><a href="tables.html#tables_manipiulations_pipeline"><i class="fa fa-check"></i><b>3.6.2</b> Конвейер манипуляций</a></li>
<li class="chapter" data-level="3.6.3" data-path="tables.html"><a href="tables.html#tables_tidy"><i class="fa fa-check"></i><b>3.6.3</b> Преобразование структуры</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="tables.html"><a href="tables.html#tables_join"><i class="fa fa-check"></i><b>3.7</b> Соединение</a></li>
<li class="chapter" data-level="3.8" data-path="tables.html"><a href="tables.html#tables_write"><i class="fa fa-check"></i><b>3.8</b> Запись</a></li>
<li class="chapter" data-level="3.9" data-path="tables.html"><a href="tables.html#tables_rules"><i class="fa fa-check"></i><b>3.9</b> Рекомендации по подготовке таблиц для чтения в R</a></li>
<li class="chapter" data-level="3.10" data-path="tables.html"><a href="tables.html#tables_review"><i class="fa fa-check"></i><b>3.10</b> Краткий обзор</a></li>
<li class="chapter" data-level="3.11" data-path="tables.html"><a href="tables.html#tables_questions"><i class="fa fa-check"></i><b>3.11</b> Контрольные вопросы и упражнения</a><ul>
<li class="chapter" data-level="3.11.1" data-path="tables.html"><a href="tables.html#tables_questions_questions"><i class="fa fa-check"></i><b>3.11.1</b> Вопросы</a></li>
<li class="chapter" data-level="3.11.2" data-path="tables.html"><a href="tables.html#tables_questions_tasks"><i class="fa fa-check"></i><b>3.11.2</b> Упражнения</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tech.html"><a href="tech.html"><i class="fa fa-check"></i><b>4</b> Техники программирования</a><ul>
<li class="chapter" data-level="4.1" data-path="tech.html"><a href="tech.html#tech-fun"><i class="fa fa-check"></i><b>4.1</b> Функциональное программирование</a><ul>
<li class="chapter" data-level="4.1.1" data-path="tech.html"><a href="tech.html#tech-fun-functions"><i class="fa fa-check"></i><b>4.1.1</b> Функции</a></li>
<li class="chapter" data-level="4.1.2" data-path="tech.html"><a href="tech.html#tech-fun-functionals"><i class="fa fa-check"></i><b>4.1.2</b> Функционалы</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tech.html"><a href="tech.html#tech-meta"><i class="fa fa-check"></i><b>4.2</b> Метапрограммирование</a></li>
<li class="chapter" data-level="4.3" data-path="tech.html"><a href="tech.html#tech_review"><i class="fa fa-check"></i><b>4.3</b> Краткий обзор</a></li>
<li class="chapter" data-level="4.4" data-path="tech.html"><a href="tech.html#tech_questions"><i class="fa fa-check"></i><b>4.4</b> Контрольные вопросы и упражнения</a><ul>
<li class="chapter" data-level="4.4.1" data-path="tech.html"><a href="tech.html#tech_questions_questions"><i class="fa fa-check"></i><b>4.4.1</b> Вопросы</a></li>
<li class="chapter" data-level="4.4.2" data-path="tech.html"><a href="tech.html#tech_questions_tasks"><i class="fa fa-check"></i><b>4.4.2</b> Упражнения</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Графика и статистика</b></span></li>
<li class="chapter" data-level="5" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>5</b> Базовая графика</a><ul>
<li class="chapter" data-level="5.1" data-path="graphics.html"><a href="graphics.html#yfxcharts"><i class="fa fa-check"></i><b>5.1</b> Стандартные графики</a><ul>
<li class="chapter" data-level="5.1.1" data-path="graphics.html"><a href="graphics.html#scatterplots"><i class="fa fa-check"></i><b>5.1.1</b> Диаграммы рассеяния</a></li>
<li class="chapter" data-level="5.1.2" data-path="graphics.html"><a href="graphics.html#linear_graphs"><i class="fa fa-check"></i><b>5.1.2</b> Линейные графики</a></li>
<li class="chapter" data-level="5.1.3" data-path="graphics.html"><a href="graphics.html#graph_combining"><i class="fa fa-check"></i><b>5.1.3</b> Совмещение графиков</a></li>
<li class="chapter" data-level="5.1.4" data-path="graphics.html"><a href="graphics.html#func_parameters"><i class="fa fa-check"></i><b>5.1.4</b> Функциональные параметры</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="graphics.html"><a href="graphics.html#histograms"><i class="fa fa-check"></i><b>5.2</b> Гистограммы</a></li>
<li class="chapter" data-level="5.3" data-path="graphics.html"><a href="graphics.html#barplots"><i class="fa fa-check"></i><b>5.3</b> Столбчатые графики</a></li>
<li class="chapter" data-level="5.4" data-path="graphics.html"><a href="graphics.html#piecharts"><i class="fa fa-check"></i><b>5.4</b> Круговые (секторные) диаграммы</a></li>
<li class="chapter" data-level="5.5" data-path="graphics.html"><a href="graphics.html#colors"><i class="fa fa-check"></i><b>5.5</b> Цвет и прозрачность</a></li>
<li class="chapter" data-level="5.6" data-path="graphics.html"><a href="graphics.html#disp_settings"><i class="fa fa-check"></i><b>5.6</b> Настройки отображения</a><ul>
<li class="chapter" data-level="5.6.1" data-path="graphics.html"><a href="graphics.html#graph_params"><i class="fa fa-check"></i><b>5.6.1</b> Графические параметры</a></li>
<li class="chapter" data-level="5.6.2" data-path="graphics.html"><a href="graphics.html#axes"><i class="fa fa-check"></i><b>5.6.2</b> Разметка осей, рамка, сетка координат и произвольные линии</a></li>
<li class="chapter" data-level="5.6.3" data-path="graphics.html"><a href="graphics.html#annotations"><i class="fa fa-check"></i><b>5.6.3</b> Аннотации данных (текст на графике)</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="graphics.html"><a href="graphics.html#legend"><i class="fa fa-check"></i><b>5.7</b> Легенда</a></li>
<li class="chapter" data-level="5.8" data-path="graphics.html"><a href="graphics.html#questions_tasks_graphics"><i class="fa fa-check"></i><b>5.8</b> Контрольные вопросы и упражнения</a><ul>
<li class="chapter" data-level="5.8.1" data-path="graphics.html"><a href="graphics.html#questions_graphics"><i class="fa fa-check"></i><b>5.8.1</b> Вопросы</a></li>
<li class="chapter" data-level="5.8.2" data-path="graphics.html"><a href="graphics.html#tasks_graphics"><i class="fa fa-check"></i><b>5.8.2</b> Упражнения</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="advgraphics.html"><a href="advgraphics.html"><i class="fa fa-check"></i><b>6</b> Продвинутая графика</a><ul>
<li class="chapter" data-level="6.1" data-path="advgraphics.html"><a href="advgraphics.html#advgraphics_prerequisites"><i class="fa fa-check"></i><b>6.1</b> Предварительные требования</a></li>
<li class="chapter" data-level="6.2" data-path="advgraphics.html"><a href="advgraphics.html#advgraphics_eurostat"><i class="fa fa-check"></i><b>6.2</b> Загрузка данных Евростата</a></li>
<li class="chapter" data-level="6.3" data-path="advgraphics.html"><a href="advgraphics.html#advgraphics_nasapower"><i class="fa fa-check"></i><b>6.3</b> Загрузка данных NASA POWER</a></li>
<li class="chapter" data-level="6.4" data-path="advgraphics.html"><a href="advgraphics.html#advgraphics_soildb"><i class="fa fa-check"></i><b>6.4</b> Загрузка данных Soil Data Access</a></li>
<li class="chapter" data-level="6.5" data-path="advgraphics.html"><a href="advgraphics.html#advgraphics_template"><i class="fa fa-check"></i><b>6.5</b> Базовый шаблон ggplot</a></li>
<li class="chapter" data-level="6.6" data-path="advgraphics.html"><a href="advgraphics.html#advgraphics_geoms"><i class="fa fa-check"></i><b>6.6</b> Геометрические типы и преобразования</a></li>
<li class="chapter" data-level="6.7" data-path="advgraphics.html"><a href="advgraphics.html#advgraphics_aes"><i class="fa fa-check"></i><b>6.7</b> Графические переменные и группировки</a></li>
<li class="chapter" data-level="6.8" data-path="advgraphics.html"><a href="advgraphics.html#advgraphics_coords"><i class="fa fa-check"></i><b>6.8</b> Системы координат</a></li>
<li class="chapter" data-level="6.9" data-path="advgraphics.html"><a href="advgraphics.html#advgraphics_titles"><i class="fa fa-check"></i><b>6.9</b> Названия осей и легенды</a></li>
<li class="chapter" data-level="6.10" data-path="advgraphics.html"><a href="advgraphics.html#advgraphics_axes"><i class="fa fa-check"></i><b>6.10</b> Разметка осей</a></li>
<li class="chapter" data-level="6.11" data-path="advgraphics.html"><a href="advgraphics.html#advgraphics_labels"><i class="fa fa-check"></i><b>6.11</b> Подписи и аннотации</a></li>
<li class="chapter" data-level="6.12" data-path="advgraphics.html"><a href="advgraphics.html#advgraphics_facets"><i class="fa fa-check"></i><b>6.12</b> Фасеты</a></li>
<li class="chapter" data-level="6.13" data-path="advgraphics.html"><a href="advgraphics.html#advgraphics_themes"><i class="fa fa-check"></i><b>6.13</b> Темы</a></li>
<li class="chapter" data-level="6.14" data-path="advgraphics.html"><a href="advgraphics.html#questions_tasks_advgraphics"><i class="fa fa-check"></i><b>6.14</b> Контрольные вопросы и упражнения</a><ul>
<li class="chapter" data-level="6.14.1" data-path="advgraphics.html"><a href="advgraphics.html#questions_advgraphics"><i class="fa fa-check"></i><b>6.14.1</b> Вопросы</a></li>
<li class="chapter" data-level="6.14.2" data-path="advgraphics.html"><a href="advgraphics.html#tasks_advgraphics"><i class="fa fa-check"></i><b>6.14.2</b> Упражнения</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="stat-analysis.html"><a href="stat-analysis.html"><i class="fa fa-check"></i><b>7</b> Основы статистики</a><ul>
<li class="chapter" data-level="7.1" data-path="stat-analysis.html"><a href="stat-analysis.html#stat_analysis_prerequisites"><i class="fa fa-check"></i><b>7.1</b> Предварительные требования</a></li>
<li class="chapter" data-level="7.2" data-path="stat-analysis.html"><a href="stat-analysis.html#stat_analysis_intro"><i class="fa fa-check"></i><b>7.2</b> Введение</a><ul>
<li class="chapter" data-level="7.2.1" data-path="stat-analysis.html"><a href="stat-analysis.html#stat_analysis_intro_sources"><i class="fa fa-check"></i><b>7.2.1</b> Источники данных</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="stat-analysis.html"><a href="stat-analysis.html#stat_analysis_one"><i class="fa fa-check"></i><b>7.3</b> Одна переменная</a><ul>
<li class="chapter" data-level="7.3.1" data-path="stat-analysis.html"><a href="stat-analysis.html#stat_analysis_one_distr"><i class="fa fa-check"></i><b>7.3.1</b> Оценка распределения</a></li>
<li class="chapter" data-level="7.3.2" data-path="stat-analysis.html"><a href="stat-analysis.html#stat_analysis_one_summary"><i class="fa fa-check"></i><b>7.3.2</b> Описательные статистики</a></li>
<li class="chapter" data-level="7.3.3" data-path="stat-analysis.html"><a href="stat-analysis.html#stat_analysis_one_tests"><i class="fa fa-check"></i><b>7.3.3</b> Статистические тесты</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="stat-analysis.html"><a href="stat-analysis.html#stat_analysis_two"><i class="fa fa-check"></i><b>7.4</b> Две переменных</a><ul>
<li class="chapter" data-level="7.4.1" data-path="stat-analysis.html"><a href="stat-analysis.html#stat_analysis_two_distr"><i class="fa fa-check"></i><b>7.4.1</b> Оценка распределения</a></li>
<li class="chapter" data-level="7.4.2" data-path="stat-analysis.html"><a href="stat-analysis.html#stat_analysis_two_distr_correg"><i class="fa fa-check"></i><b>7.4.2</b> Корреляция и регрессия</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="stat-analysis.html"><a href="stat-analysis.html#questions_tasks_stat_analysis"><i class="fa fa-check"></i><b>7.5</b> Контрольные вопросы и упражнения</a><ul>
<li class="chapter" data-level="7.5.1" data-path="stat-analysis.html"><a href="stat-analysis.html#questions_stat_analysis"><i class="fa fa-check"></i><b>7.5.1</b> Вопросы</a></li>
<li class="chapter" data-level="7.5.2" data-path="stat-analysis.html"><a href="stat-analysis.html#tasks_stat_analysis"><i class="fa fa-check"></i><b>7.5.2</b> Упражнения</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="circular.html"><a href="circular.html"><i class="fa fa-check"></i><b>8</b> Дирекционные и временные данные</a><ul>
<li class="chapter" data-level="8.1" data-path="circular.html"><a href="circular.html#circular_prerequisites"><i class="fa fa-check"></i><b>8.1</b> Предварительные требования</a></li>
<li class="chapter" data-level="8.2" data-path="circular.html"><a href="circular.html#circular_circ"><i class="fa fa-check"></i><b>8.2</b> Статистика направлений</a><ul>
<li class="chapter" data-level="8.2.1" data-path="circular.html"><a href="circular.html#circular_circ_theory"><i class="fa fa-check"></i><b>8.2.1</b> Теория</a></li>
<li class="chapter" data-level="8.2.2" data-path="circular.html"><a href="circular.html#circular_circ_vis"><i class="fa fa-check"></i><b>8.2.2</b> Практика</a></li>
<li class="chapter" data-level="8.2.3" data-path="circular.html"><a href="circular.html#circular_tests"><i class="fa fa-check"></i><b>8.2.3</b> Описательные статистики и тесты</a></li>
<li class="chapter" data-level="8.2.4" data-path="circular.html"><a href="circular.html#circular_correlation"><i class="fa fa-check"></i><b>8.2.4</b> Корреляция и регрессия</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="circular.html"><a href="circular.html#circular_time"><i class="fa fa-check"></i><b>8.3</b> Временные ряды</a><ul>
<li class="chapter" data-level="8.3.1" data-path="circular.html"><a href="circular.html#circular_time_lubridate"><i class="fa fa-check"></i><b>8.3.1</b> Создание и преобразование дат и времени</a></li>
<li class="chapter" data-level="8.3.2" data-path="circular.html"><a href="circular.html#circular_time_complete"><i class="fa fa-check"></i><b>8.3.2</b> Восстановление пропусков и проверка корректности дат</a></li>
<li class="chapter" data-level="8.3.3" data-path="circular.html"><a href="circular.html#circular_time_interp"><i class="fa fa-check"></i><b>8.3.3</b> Интерполяция по времени</a></li>
<li class="chapter" data-level="8.3.4" data-path="circular.html"><a href="circular.html#circular_loess"><i class="fa fa-check"></i><b>8.3.4</b> Аппроксимация по времени</a></li>
<li class="chapter" data-level="8.3.5" data-path="circular.html"><a href="circular.html#circular_time_tests"><i class="fa fa-check"></i><b>8.3.5</b> Статистики</a></li>
<li class="chapter" data-level="8.3.6" data-path="circular.html"><a href="circular.html#circular_time_animation"><i class="fa fa-check"></i><b>8.3.6</b> Анимация</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="circular.html"><a href="circular.html#questions_tasks_circular"><i class="fa fa-check"></i><b>8.4</b> Контрольные вопросы и упражнения</a><ul>
<li class="chapter" data-level="8.4.1" data-path="circular.html"><a href="circular.html#questions_circular"><i class="fa fa-check"></i><b>8.4.1</b> Вопросы</a></li>
<li class="chapter" data-level="8.4.2" data-path="circular.html"><a href="circular.html#tasks_circular"><i class="fa fa-check"></i><b>8.4.2</b> Упражнения</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Пространственные данные</b></span></li>
<li class="chapter" data-level="9" data-path="spatial-data.html"><a href="spatial-data.html"><i class="fa fa-check"></i><b>9</b> Пространственные данные</a><ul>
<li class="chapter" data-level="9.1" data-path="circular.html"><a href="circular.html#circular_prerequisites"><i class="fa fa-check"></i><b>9.1</b> Предварительные требования</a></li>
<li class="chapter" data-level="9.2" data-path="spatial-data.html"><a href="spatial-data.html#spatial_models"><i class="fa fa-check"></i><b>9.2</b> Модели пространственных данных</a><ul>
<li class="chapter" data-level="9.2.1" data-path="spatial-data.html"><a href="spatial-data.html#simple_features"><i class="fa fa-check"></i><b>9.2.1</b> Векторные данные</a></li>
<li class="chapter" data-level="9.2.2" data-path="spatial-data.html"><a href="spatial-data.html#raster_data"><i class="fa fa-check"></i><b>9.2.2</b> Растровые данные</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="spatial-data.html"><a href="spatial-data.html#spatref"><i class="fa fa-check"></i><b>9.3</b> Пространственная привязка</a><ul>
<li class="chapter" data-level="9.3.1" data-path="spatial-data.html"><a href="spatial-data.html#spatref_components"><i class="fa fa-check"></i><b>9.3.1</b> Компоненты пространственной привязки</a></li>
<li class="chapter" data-level="9.3.2" data-path="spatial-data.html"><a href="spatial-data.html#spatref_formats"><i class="fa fa-check"></i><b>9.3.2</b> Форматы описания пространственной привязки</a></li>
<li class="chapter" data-level="9.3.3" data-path="spatial-data.html"><a href="spatial-data.html#spatref_transform"><i class="fa fa-check"></i><b>9.3.3</b> Преобразование координат</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="spatial-data.html"><a href="spatial-data.html#vector_data_r"><i class="fa fa-check"></i><b>9.4</b> Векторные данные</a><ul>
<li class="chapter" data-level="9.4.1" data-path="spatial-data.html"><a href="spatial-data.html#vector_data_packages"><i class="fa fa-check"></i><b>9.4.1</b> Базовые библиотеки</a></li>
<li class="chapter" data-level="9.4.2" data-path="spatial-data.html"><a href="spatial-data.html#vector_data_reading"><i class="fa fa-check"></i><b>9.4.2</b> Чтение</a></li>
<li class="chapter" data-level="9.4.3" data-path="spatial-data.html"><a href="spatial-data.html#sf_structure"><i class="fa fa-check"></i><b>9.4.3</b> Внутренняя структура</a></li>
<li class="chapter" data-level="9.4.4" data-path="spatial-data.html"><a href="spatial-data.html#sf_plotting"><i class="fa fa-check"></i><b>9.4.4</b> Визуализация</a></li>
<li class="chapter" data-level="9.4.5" data-path="spatial-data.html"><a href="spatial-data.html#sf_crs"><i class="fa fa-check"></i><b>9.4.5</b> Системы координат и проекции</a></li>
<li class="chapter" data-level="9.4.6" data-path="spatial-data.html"><a href="spatial-data.html#sf_attrs"><i class="fa fa-check"></i><b>9.4.6</b> Атрибутивные операции</a></li>
<li class="chapter" data-level="9.4.7" data-path="spatial-data.html"><a href="spatial-data.html#sf_spat_selection"><i class="fa fa-check"></i><b>9.4.7</b> Пространственные операции</a></li>
<li class="chapter" data-level="9.4.8" data-path="spatial-data.html"><a href="spatial-data.html#sf_creation"><i class="fa fa-check"></i><b>9.4.8</b> Создание пространственных объектов</a></li>
<li class="chapter" data-level="9.4.9" data-path="spatial-data.html"><a href="spatial-data.html#sf_geom_attrs"><i class="fa fa-check"></i><b>9.4.9</b> Геометрические атрибуты</a></li>
<li class="chapter" data-level="9.4.10" data-path="spatial-data.html"><a href="spatial-data.html#sf_export"><i class="fa fa-check"></i><b>9.4.10</b> Экспорт</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="spatial-data.html"><a href="spatial-data.html#raster_data_r"><i class="fa fa-check"></i><b>9.5</b> Растровые данные</a><ul>
<li class="chapter" data-level="9.5.1" data-path="spatial-data.html"><a href="spatial-data.html#raster_read"><i class="fa fa-check"></i><b>9.5.1</b> Чтение</a></li>
<li class="chapter" data-level="9.5.2" data-path="spatial-data.html"><a href="spatial-data.html#raster_viz"><i class="fa fa-check"></i><b>9.5.2</b> Визуализация</a></li>
<li class="chapter" data-level="9.5.3" data-path="spatial-data.html"><a href="spatial-data.html#raster_proj"><i class="fa fa-check"></i><b>9.5.3</b> Системы координат и проекции</a></li>
<li class="chapter" data-level="9.5.4" data-path="spatial-data.html"><a href="spatial-data.html#raster_values"><i class="fa fa-check"></i><b>9.5.4</b> Операции со значениями</a></li>
<li class="chapter" data-level="9.5.5" data-path="spatial-data.html"><a href="spatial-data.html#raster_export"><i class="fa fa-check"></i><b>9.5.5</b> Экспорт</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="spatial-data.html"><a href="spatial-data.html#spatial_ggplot2"><i class="fa fa-check"></i><b>9.6</b> Визуализация средствами ggplot2</a></li>
<li class="chapter" data-level="9.7" data-path="spatial-data.html"><a href="spatial-data.html#spatial_interactive"><i class="fa fa-check"></i><b>9.7</b> Интерактивные карты</a></li>
<li class="chapter" data-level="9.8" data-path="spatial-data.html"><a href="spatial-data.html#questions_tasks_spatial"><i class="fa fa-check"></i><b>9.8</b> Контрольные вопросы и упражнения</a><ul>
<li class="chapter" data-level="9.8.1" data-path="spatial-data.html"><a href="spatial-data.html#questions_spatial"><i class="fa fa-check"></i><b>9.8.1</b> Вопросы</a></li>
<li class="chapter" data-level="9.8.2" data-path="spatial-data.html"><a href="spatial-data.html#tasks_spatial"><i class="fa fa-check"></i><b>9.8.2</b> Упражнения</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html"><i class="fa fa-check"></i><b>10</b> Тематические карты</a><ul>
<li class="chapter" data-level="" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#предварительные-условия"><i class="fa fa-check"></i>Предварительные условия</a></li>
<li class="chapter" data-level="10.1" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#thematic_mapping_intro"><i class="fa fa-check"></i><b>10.1</b> Введение</a><ul>
<li class="chapter" data-level="10.1.1" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#thematic_mapping_intro_ne"><i class="fa fa-check"></i><b>10.1.1</b> Данные Natural Earth</a></li>
<li class="chapter" data-level="10.1.2" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#thematic_mapping_intro_wc"><i class="fa fa-check"></i><b>10.1.2</b> Данные WorldClim</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#thematic_mapping_tmap"><i class="fa fa-check"></i><b>10.2</b> Способы изображения</a><ul>
<li class="chapter" data-level="10.2.1" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#thematic_mapping_vectors"><i class="fa fa-check"></i><b>10.2.1</b> Векторные данные</a></li>
<li class="chapter" data-level="10.2.2" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#thematic_mapping_rasters"><i class="fa fa-check"></i><b>10.2.2</b> Растровые данные</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#thematic_color_scales"><i class="fa fa-check"></i><b>10.3</b> Цветовые шкалы</a></li>
<li class="chapter" data-level="10.4" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#thematic_mapping_class"><i class="fa fa-check"></i><b>10.4</b> Классификация</a><ul>
<li class="chapter" data-level="10.4.1" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#thematic_mapping_class_methods"><i class="fa fa-check"></i><b>10.4.1</b> Методы классификации</a></li>
<li class="chapter" data-level="10.4.2" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#thematic_mapping_class_application"><i class="fa fa-check"></i><b>10.4.2</b> Применение на картах</a></li>
<li class="chapter" data-level="10.4.3" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#thematic_mapping_class_application"><i class="fa fa-check"></i><b>10.4.3</b> Классификация при отображении</a></li>
<li class="chapter" data-level="10.4.4" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#thematic_mapping_na"><i class="fa fa-check"></i><b>10.4.4</b> Пропущенные данные</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#thematic_mapping_layouts"><i class="fa fa-check"></i><b>10.5</b> Компоновка</a></li>
<li class="chapter" data-level="10.6" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#thematic_mapping_facets"><i class="fa fa-check"></i><b>10.6</b> Фасеты и серии карт</a></li>
<li class="chapter" data-level="10.7" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#thematic_mapping_animations"><i class="fa fa-check"></i><b>10.7</b> Картографические анимации</a></li>
<li class="chapter" data-level="10.8" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#thematic_mapping_interactive"><i class="fa fa-check"></i><b>10.8</b> Интерактивные карты</a></li>
<li class="chapter" data-level="10.9" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#questions_tasks_tmap"><i class="fa fa-check"></i><b>10.9</b> Контрольные вопросы и упражнения</a><ul>
<li class="chapter" data-level="10.9.1" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#questions_tmap"><i class="fa fa-check"></i><b>10.9.1</b> Вопросы</a></li>
<li class="chapter" data-level="10.9.2" data-path="thematic-mapping-new.html"><a href="thematic-mapping-new.html#tasks_tmap"><i class="fa fa-check"></i><b>10.9.2</b> Упражнения</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="vector-analysis.html"><a href="vector-analysis.html"><i class="fa fa-check"></i><b>11</b> Векторный и сетевой анализ</a><ul>
<li class="chapter" data-level="11.1" data-path="vector-analysis.html"><a href="vector-analysis.html#spatial_queries"><i class="fa fa-check"></i><b>11.1</b> Пространственные запросы</a><ul>
<li class="chapter" data-level="11.1.1" data-path="vector-analysis.html"><a href="vector-analysis.html#context_objects"><i class="fa fa-check"></i><b>11.1.1</b> Контекстные и целевые объекты</a></li>
<li class="chapter" data-level="11.1.2" data-path="vector-analysis.html"><a href="vector-analysis.html#zones"><i class="fa fa-check"></i><b>11.1.2</b> Зоны окружения объектов</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="vector-analysis.html"><a href="vector-analysis.html#use_case"><i class="fa fa-check"></i><b>11.2</b> Постановка задач и изучение данных</a></li>
<li class="chapter" data-level="11.3" data-path="vector-analysis.html"><a href="vector-analysis.html#distance_analysis"><i class="fa fa-check"></i><b>11.3</b> Анализ расстояний</a></li>
<li class="chapter" data-level="11.4" data-path="vector-analysis.html"><a href="vector-analysis.html#topology_analysis"><i class="fa fa-check"></i><b>11.4</b> Анализ взаимного положения (топологический)</a></li>
<li class="chapter" data-level="11.5" data-path="vector-analysis.html"><a href="vector-analysis.html#absolute_zones"><i class="fa fa-check"></i><b>11.5</b> Анализ абсолютных зон окружения</a></li>
<li class="chapter" data-level="11.6" data-path="vector-analysis.html"><a href="vector-analysis.html#conc_zones"><i class="fa fa-check"></i><b>11.6</b> Анализ конкурентных зон окружения</a></li>
<li class="chapter" data-level="11.7" data-path="vector-analysis.html"><a href="vector-analysis.html#transport_zones"><i class="fa fa-check"></i><b>11.7</b> Анализ зон транспортной доступности</a></li>
<li class="chapter" data-level="11.8" data-path="vector-analysis.html"><a href="vector-analysis.html#routes"><i class="fa fa-check"></i><b>11.8</b> Построение маршрутов и матриц времени движения</a></li>
<li class="chapter" data-level="11.9" data-path="vector-analysis.html"><a href="vector-analysis.html#qtasks_vector_analysis"><i class="fa fa-check"></i><b>11.9</b> Контрольные вопросы и упражнения</a><ul>
<li class="chapter" data-level="11.9.1" data-path="vector-analysis.html"><a href="vector-analysis.html#questions_vector_analysis"><i class="fa fa-check"></i><b>11.9.1</b> Вопросы</a></li>
<li class="chapter" data-level="11.9.2" data-path="vector-analysis.html"><a href="vector-analysis.html#tasks_vector_analysis"><i class="fa fa-check"></i><b>11.9.2</b> Упражнения</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="raster-analysis.html"><a href="raster-analysis.html"><i class="fa fa-check"></i><b>12</b> Растровый анализ</a><ul>
<li class="chapter" data-level="" data-path="raster-analysis.html"><a href="raster-analysis.html#предварительные-условия-1"><i class="fa fa-check"></i>Предварительные условия</a></li>
<li class="chapter" data-level="12.1" data-path="raster-analysis.html"><a href="raster-analysis.html#raster_intro"><i class="fa fa-check"></i><b>12.1</b> Введение</a></li>
<li class="chapter" data-level="12.2" data-path="raster-analysis.html"><a href="raster-analysis.html#растровая-алгебра"><i class="fa fa-check"></i><b>12.2</b> Растровая алгебра</a><ul>
<li class="chapter" data-level="12.2.1" data-path="raster-analysis.html"><a href="raster-analysis.html#raster_local"><i class="fa fa-check"></i><b>12.2.1</b> Локальные операции</a></li>
<li class="chapter" data-level="12.2.2" data-path="raster-analysis.html"><a href="raster-analysis.html#raster_focal"><i class="fa fa-check"></i><b>12.2.2</b> Фокальные операции</a></li>
<li class="chapter" data-level="12.2.3" data-path="raster-analysis.html"><a href="raster-analysis.html#raster_zonal"><i class="fa fa-check"></i><b>12.2.3</b> Зональные операции</a></li>
<li class="chapter" data-level="12.2.4" data-path="raster-analysis.html"><a href="raster-analysis.html#raster_global"><i class="fa fa-check"></i><b>12.2.4</b> Глобальные операции</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="raster-analysis.html"><a href="raster-analysis.html#raster_extract"><i class="fa fa-check"></i><b>12.3</b> Извлечение данных</a></li>
<li class="chapter" data-level="12.4" data-path="raster-analysis.html"><a href="raster-analysis.html#questions_tasks_raster"><i class="fa fa-check"></i><b>12.4</b> Контрольные вопросы и упражнения</a><ul>
<li class="chapter" data-level="12.4.1" data-path="raster-analysis.html"><a href="raster-analysis.html#questions_raster"><i class="fa fa-check"></i><b>12.4.1</b> Вопросы</a></li>
<li class="chapter" data-level="12.4.2" data-path="raster-analysis.html"><a href="raster-analysis.html#tasks_raster"><i class="fa fa-check"></i><b>12.4.2</b> Упражнения</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Пространственная статистика</b></span></li>
<li class="chapter" data-level="13" data-path="interpolation-deterministic.html"><a href="interpolation-deterministic.html"><i class="fa fa-check"></i><b>13</b> Моделирование геополей</a><ul>
<li class="chapter" data-level="13.1" data-path="interpolation-deterministic.html"><a href="interpolation-deterministic.html#interpolation_intro"><i class="fa fa-check"></i><b>13.1</b> Введение</a></li>
<li class="chapter" data-level="13.2" data-path="interpolation-deterministic.html"><a href="interpolation-deterministic.html#interpolation_grid"><i class="fa fa-check"></i><b>13.2</b> Построение сетки</a></li>
<li class="chapter" data-level="13.3" data-path="interpolation-deterministic.html"><a href="interpolation-deterministic.html#interpolation_methods"><i class="fa fa-check"></i><b>13.3</b> Интерполяционные методы</a><ul>
<li class="chapter" data-level="13.3.1" data-path="interpolation-deterministic.html"><a href="interpolation-deterministic.html#interpolation_nn"><i class="fa fa-check"></i><b>13.3.1</b> Метод ближайшего соседа (nearest neighbour)</a></li>
<li class="chapter" data-level="13.3.2" data-path="interpolation-deterministic.html"><a href="interpolation-deterministic.html#interpolation_tin"><i class="fa fa-check"></i><b>13.3.2</b> Интерполяция на основе триангуляции</a></li>
<li class="chapter" data-level="13.3.3" data-path="interpolation-deterministic.html"><a href="interpolation-deterministic.html#interpolation_idw"><i class="fa fa-check"></i><b>13.3.3</b> Метод обратно взвешенных расстояний (IDW)</a></li>
<li class="chapter" data-level="13.3.4" data-path="interpolation-deterministic.html"><a href="interpolation-deterministic.html#interpolation_rbf"><i class="fa fa-check"></i><b>13.3.4</b> Метод радиальных базисных функций (РБФ)</a></li>
<li class="chapter" data-level="13.3.5" data-path="interpolation-deterministic.html"><a href="interpolation-deterministic.html#interpolation_bspline"><i class="fa fa-check"></i><b>13.3.5</b> Метод иерархических базисных сплайнов (B-сплайнов)</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="interpolation-deterministic.html"><a href="interpolation-deterministic.html#approximation_methods"><i class="fa fa-check"></i><b>13.4</b> Аппроксимационные методы</a><ul>
<li class="chapter" data-level="13.4.1" data-path="interpolation-deterministic.html"><a href="interpolation-deterministic.html#approximation_global"><i class="fa fa-check"></i><b>13.4.1</b> Глобальный тренд</a></li>
<li class="chapter" data-level="13.4.2" data-path="interpolation-deterministic.html"><a href="interpolation-deterministic.html#approximation_local"><i class="fa fa-check"></i><b>13.4.2</b> Локальный тренд</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="interpolation-deterministic.html"><a href="interpolation-deterministic.html#areal_interpolation"><i class="fa fa-check"></i><b>13.5</b> Интерполяция по ареалам</a></li>
<li class="chapter" data-level="13.6" data-path="interpolation-deterministic.html"><a href="interpolation-deterministic.html#interp_review"><i class="fa fa-check"></i><b>13.6</b> Краткий обзор</a></li>
<li class="chapter" data-level="13.7" data-path="interpolation-deterministic.html"><a href="interpolation-deterministic.html#questions_tasks_interp"><i class="fa fa-check"></i><b>13.7</b> Контрольные вопросы и упражнения</a><ul>
<li class="chapter" data-level="13.7.1" data-path="interpolation-deterministic.html"><a href="interpolation-deterministic.html#questions_interp"><i class="fa fa-check"></i><b>13.7.1</b> Вопросы</a></li>
<li class="chapter" data-level="13.7.2" data-path="interpolation-deterministic.html"><a href="interpolation-deterministic.html#tasks_interp"><i class="fa fa-check"></i><b>13.7.2</b> Упражнения</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="kriging.html"><a href="kriging.html"><i class="fa fa-check"></i><b>14</b> Геостатистика</a><ul>
<li class="chapter" data-level="14.1" data-path="kriging.html"><a href="kriging.html#введение-1"><i class="fa fa-check"></i><b>14.1</b> Введение</a></li>
<li class="chapter" data-level="14.2" data-path="kriging.html"><a href="kriging.html#базовые-понятия-и-элементы-геостатистики"><i class="fa fa-check"></i><b>14.2</b> Базовые понятия и элементы геостатистики</a><ul>
<li class="chapter" data-level="14.2.1" data-path="kriging.html"><a href="kriging.html#базовые-понятия"><i class="fa fa-check"></i><b>14.2.1</b> Базовые понятия</a></li>
<li class="chapter" data-level="14.2.2" data-path="kriging.html"><a href="kriging.html#случайный-процесс-в-пространстве-и-его-моменты"><i class="fa fa-check"></i><b>14.2.2</b> Случайный процесс в пространстве и его моменты</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="kriging.html"><a href="kriging.html#стационарность-и-эргодичность"><i class="fa fa-check"></i><b>14.3</b> Стационарность и эргодичность</a><ul>
<li class="chapter" data-level="14.3.1" data-path="kriging.html"><a href="kriging.html#стационарность"><i class="fa fa-check"></i><b>14.3.1</b> Стационарность</a></li>
<li class="chapter" data-level="14.3.2" data-path="kriging.html"><a href="kriging.html#эргодичность"><i class="fa fa-check"></i><b>14.3.2</b> Эргодичность</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="kriging.html"><a href="kriging.html#геостатистическое-оценивание"><i class="fa fa-check"></i><b>14.4</b> Геостатистическое оценивание</a><ul>
<li class="chapter" data-level="14.4.1" data-path="kriging.html"><a href="kriging.html#простой-кригинг"><i class="fa fa-check"></i><b>14.4.1</b> Простой кригинг</a></li>
<li class="chapter" data-level="14.4.2" data-path="kriging.html"><a href="kriging.html#дисперсия-простого-кригинга"><i class="fa fa-check"></i><b>14.4.2</b> Дисперсия простого кригинга</a></li>
<li class="chapter" data-level="14.4.3" data-path="kriging.html"><a href="kriging.html#стационарность-приращений"><i class="fa fa-check"></i><b>14.4.3</b> Стационарность приращений</a></li>
<li class="chapter" data-level="14.4.4" data-path="kriging.html"><a href="kriging.html#переход-от-ковариации-к-вариограмме"><i class="fa fa-check"></i><b>14.4.4</b> Переход от ковариации к вариограмме</a></li>
<li class="chapter" data-level="14.4.5" data-path="kriging.html"><a href="kriging.html#обычный-кригинг"><i class="fa fa-check"></i><b>14.4.5</b> Обычный кригинг</a></li>
<li class="chapter" data-level="14.4.6" data-path="kriging.html"><a href="kriging.html#дисперсия-обычного-кригинга"><i class="fa fa-check"></i><b>14.4.6</b> Дисперсия обычного кригинга</a></li>
<li class="chapter" data-level="14.4.7" data-path="kriging.html"><a href="kriging.html#универсальный-кригинг"><i class="fa fa-check"></i><b>14.4.7</b> Универсальный кригинг</a></li>
<li class="chapter" data-level="14.4.8" data-path="kriging.html"><a href="kriging.html#дисперсия-универсального-кригинга"><i class="fa fa-check"></i><b>14.4.8</b> Дисперсия универсального кригинга</a></li>
<li class="chapter" data-level="14.4.9" data-path="kriging.html"><a href="kriging.html#кросс-валидация"><i class="fa fa-check"></i><b>14.4.9</b> Кросс-валидация</a></li>
<li class="chapter" data-level="14.4.10" data-path="kriging.html"><a href="kriging.html#вариограмма"><i class="fa fa-check"></i><b>14.4.10</b> Вариограмма</a></li>
<li class="chapter" data-level="14.4.11" data-path="kriging.html"><a href="kriging.html#модели-вариограмм"><i class="fa fa-check"></i><b>14.4.11</b> Модели вариограмм</a></li>
<li class="chapter" data-level="14.4.12" data-path="kriging.html"><a href="kriging.html#сферическая-модель"><i class="fa fa-check"></i><b>14.4.12</b> Сферическая модель</a></li>
<li class="chapter" data-level="14.4.13" data-path="kriging.html"><a href="kriging.html#экспоненциальная-модель"><i class="fa fa-check"></i><b>14.4.13</b> Экспоненциальная модель</a></li>
<li class="chapter" data-level="14.4.14" data-path="kriging.html"><a href="kriging.html#гауссова-модель"><i class="fa fa-check"></i><b>14.4.14</b> Гауссова модель</a></li>
<li class="chapter" data-level="14.4.15" data-path="kriging.html"><a href="kriging.html#степенная-модель"><i class="fa fa-check"></i><b>14.4.15</b> Степенная модель</a></li>
<li class="chapter" data-level="14.4.16" data-path="kriging.html"><a href="kriging.html#эффект-самородка-модель-наггет"><i class="fa fa-check"></i><b>14.4.16</b> Эффект самородка (модель наггет)</a></li>
<li class="chapter" data-level="14.4.17" data-path="kriging.html"><a href="kriging.html#диаграмма-рассеяния-с-лагом"><i class="fa fa-check"></i><b>14.4.17</b> Диаграмма рассеяния с лагом</a></li>
<li class="chapter" data-level="14.4.18" data-path="kriging.html"><a href="kriging.html#вариограммное-облако"><i class="fa fa-check"></i><b>14.4.18</b> Вариограммное облако</a></li>
<li class="chapter" data-level="14.4.19" data-path="kriging.html"><a href="kriging.html#эмпирическая-вариограмма"><i class="fa fa-check"></i><b>14.4.19</b> Эмпирическая вариограмма</a></li>
<li class="chapter" data-level="14.4.20" data-path="kriging.html"><a href="kriging.html#вариокарта"><i class="fa fa-check"></i><b>14.4.20</b> Вариокарта</a></li>
<li class="chapter" data-level="14.4.21" data-path="kriging.html"><a href="kriging.html#приближение-теоретической-модели"><i class="fa fa-check"></i><b>14.4.21</b> Приближение теоретической модели</a></li>
<li class="chapter" data-level="14.4.22" data-path="kriging.html"><a href="kriging.html#обычный-кригинг-1"><i class="fa fa-check"></i><b>14.4.22</b> Обычный кригинг</a></li>
<li class="chapter" data-level="14.4.23" data-path="kriging.html"><a href="kriging.html#обычный-кригинг-2"><i class="fa fa-check"></i><b>14.4.23</b> Обычный кригинг</a></li>
<li class="chapter" data-level="14.4.24" data-path="kriging.html"><a href="kriging.html#оценка-и-дисперсия-кригинга"><i class="fa fa-check"></i><b>14.4.24</b> Оценка и дисперсия кригинга</a></li>
<li class="chapter" data-level="14.4.25" data-path="kriging.html"><a href="kriging.html#кросс-валидация-1"><i class="fa fa-check"></i><b>14.4.25</b> Кросс-валидация</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="kriging.html"><a href="kriging.html#geostat_review"><i class="fa fa-check"></i><b>14.5</b> Краткий обзор</a></li>
<li class="chapter" data-level="14.6" data-path="kriging.html"><a href="kriging.html#geostat_qt"><i class="fa fa-check"></i><b>14.6</b> Контрольные вопросы и упражнения</a><ul>
<li class="chapter" data-level="14.6.1" data-path="kriging.html"><a href="kriging.html#geostat_q"><i class="fa fa-check"></i><b>14.6.1</b> Вопросы</a></li>
<li class="chapter" data-level="14.6.2" data-path="kriging.html"><a href="kriging.html#geostat_t"><i class="fa fa-check"></i><b>14.6.2</b> Упражнения</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="autocorrelation.html"><a href="autocorrelation.html"><i class="fa fa-check"></i><b>15</b> Пространственная регрессия</a><ul>
<li class="chapter" data-level="15.1" data-path="autocorrelation.html"><a href="autocorrelation.html#autocorrelation_intro"><i class="fa fa-check"></i><b>15.1</b> Введение</a></li>
<li class="chapter" data-level="15.2" data-path="autocorrelation.html"><a href="autocorrelation.html#линейная-регрессия"><i class="fa fa-check"></i><b>15.2</b> Линейная регрессия</a></li>
<li class="chapter" data-level="15.3" data-path="autocorrelation.html"><a href="autocorrelation.html#пространственная-регрессия"><i class="fa fa-check"></i><b>15.3</b> Пространственная регрессия</a></li>
<li class="chapter" data-level="15.4" data-path="autocorrelation.html"><a href="autocorrelation.html#практический-анализ"><i class="fa fa-check"></i><b>15.4</b> Практический анализ</a></li>
<li class="chapter" data-level="15.5" data-path="autocorrelation.html"><a href="autocorrelation.html#autocorrelation_neighbors"><i class="fa fa-check"></i><b>15.5</b> Пространственное соседство</a><ul>
<li class="chapter" data-level="15.5.1" data-path="autocorrelation.html"><a href="autocorrelation.html#autocorrelation_neighbors_contguity"><i class="fa fa-check"></i><b>15.5.1</b> Соседи по смежности</a></li>
<li class="chapter" data-level="15.5.2" data-path="autocorrelation.html"><a href="autocorrelation.html#autocorrelation_neighbors_graph"><i class="fa fa-check"></i><b>15.5.2</b> Соседи по графу</a></li>
<li class="chapter" data-level="15.5.3" data-path="autocorrelation.html"><a href="autocorrelation.html#autocorrelation_neighbors_metrics"><i class="fa fa-check"></i><b>15.5.3</b> Соседи по метрике</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="autocorrelation.html"><a href="autocorrelation.html#autocorrelation_weights"><i class="fa fa-check"></i><b>15.6</b> Пространственные веса</a></li>
<li class="chapter" data-level="15.7" data-path="autocorrelation.html"><a href="autocorrelation.html#autocorrelation_measures"><i class="fa fa-check"></i><b>15.7</b> Пространственная автокорреляция</a><ul>
<li class="chapter" data-level="15.7.1" data-path="autocorrelation.html"><a href="autocorrelation.html#autocorrelation_moran"><i class="fa fa-check"></i><b>15.7.1</b> Индекс Морана (Moran’s I)</a></li>
<li class="chapter" data-level="15.7.2" data-path="autocorrelation.html"><a href="autocorrelation.html#autocorrelation_permutation"><i class="fa fa-check"></i><b>15.7.2</b> Перестановочный тест Морана</a></li>
<li class="chapter" data-level="15.7.3" data-path="autocorrelation.html"><a href="autocorrelation.html#autocorrelation_moranscatter"><i class="fa fa-check"></i><b>15.7.3</b> Диаграмма рассеяния Морана</a></li>
<li class="chapter" data-level="15.7.4" data-path="autocorrelation.html"><a href="autocorrelation.html#autocorrelation_autoregression"><i class="fa fa-check"></i><b>15.7.4</b> Пространственная авторегрессия</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="autocorrelation.html"><a href="autocorrelation.html#autocorrelation_gwr"><i class="fa fa-check"></i><b>15.8</b> Географически взвешенная регрессия (GWR)</a><ul>
<li class="chapter" data-level="15.8.1" data-path="autocorrelation.html"><a href="autocorrelation.html#весовые-функции"><i class="fa fa-check"></i><b>15.8.1</b> Весовые функции</a></li>
<li class="chapter" data-level="15.8.2" data-path="autocorrelation.html"><a href="autocorrelation.html#практический-анализ-1"><i class="fa fa-check"></i><b>15.8.2</b> Практический анализ</a></li>
</ul></li>
<li class="chapter" data-level="15.9" data-path="autocorrelation.html"><a href="autocorrelation.html#spreg_review"><i class="fa fa-check"></i><b>15.9</b> Краткий обзор</a></li>
<li class="chapter" data-level="15.10" data-path="autocorrelation.html"><a href="autocorrelation.html#questions_tasks_spreg"><i class="fa fa-check"></i><b>15.10</b> Контрольные вопросы и упражнения</a><ul>
<li class="chapter" data-level="15.10.1" data-path="autocorrelation.html"><a href="autocorrelation.html#questions_spreg"><i class="fa fa-check"></i><b>15.10.1</b> Вопросы</a></li>
<li class="chapter" data-level="15.10.2" data-path="autocorrelation.html"><a href="autocorrelation.html#tasks_spreg"><i class="fa fa-check"></i><b>15.10.2</b> Упражнения</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="point-patterns.html"><a href="point-patterns.html"><i class="fa fa-check"></i><b>16</b> Точечные процессы</a><ul>
<li class="chapter" data-level="16.1" data-path="point-patterns.html"><a href="point-patterns.html#точечный-паттерн"><i class="fa fa-check"></i><b>16.1</b> Точечный паттерн</a></li>
<li class="chapter" data-level="16.2" data-path="point-patterns.html"><a href="point-patterns.html#точечные-процессы"><i class="fa fa-check"></i><b>16.2</b> Точечные процессы</a><ul>
<li class="chapter" data-level="16.2.1" data-path="point-patterns.html"><a href="point-patterns.html#равномерно-случайные-точки"><i class="fa fa-check"></i><b>16.2.1</b> Равномерно случайные точки</a></li>
<li class="chapter" data-level="16.2.2" data-path="point-patterns.html"><a href="point-patterns.html#биномиальный-точечный-процесс"><i class="fa fa-check"></i><b>16.2.2</b> Биномиальный точечный процесс</a></li>
<li class="chapter" data-level="16.2.3" data-path="point-patterns.html"><a href="point-patterns.html#пуассоновский-процесс"><i class="fa fa-check"></i><b>16.2.3</b> Пуассоновский процесс</a></li>
<li class="chapter" data-level="16.2.4" data-path="point-patterns.html"><a href="point-patterns.html#неоднородный-пуассоновский-процесс"><i class="fa fa-check"></i><b>16.2.4</b> Неоднородный пуассоновский процесс</a></li>
<li class="chapter" data-level="16.2.5" data-path="point-patterns.html"><a href="point-patterns.html#процесс-кокса-cox-process"><i class="fa fa-check"></i><b>16.2.5</b> Процесс Кокса (Cox process)</a></li>
<li class="chapter" data-level="16.2.6" data-path="point-patterns.html"><a href="point-patterns.html#кластерные-процессы"><i class="fa fa-check"></i><b>16.2.6</b> Кластерные процессы</a></li>
<li class="chapter" data-level="16.2.7" data-path="point-patterns.html"><a href="point-patterns.html#регулярные-процессы"><i class="fa fa-check"></i><b>16.2.7</b> Регулярные процессы</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="point-patterns.html"><a href="point-patterns.html#диагностика"><i class="fa fa-check"></i><b>16.3</b> Диагностика</a><ul>
<li class="chapter" data-level="16.3.1" data-path="point-patterns.html"><a href="point-patterns.html#анализ-интенсивности"><i class="fa fa-check"></i><b>16.3.1</b> Анализ интенсивности</a></li>
<li class="chapter" data-level="16.3.2" data-path="point-patterns.html"><a href="point-patterns.html#анализ-зависимости"><i class="fa fa-check"></i><b>16.3.2</b> Анализ зависимости</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="point-patterns.html"><a href="point-patterns.html#моделирование"><i class="fa fa-check"></i><b>16.4</b> Моделирование</a></li>
<li class="chapter" data-level="16.5" data-path="point-patterns.html"><a href="point-patterns.html#point_review"><i class="fa fa-check"></i><b>16.5</b> Краткий обзор</a></li>
<li class="chapter" data-level="16.6" data-path="point-patterns.html"><a href="point-patterns.html#questions_tasks_patterns"><i class="fa fa-check"></i><b>16.6</b> Контрольные вопросы и упражнения</a><ul>
<li class="chapter" data-level="16.6.1" data-path="point-patterns.html"><a href="point-patterns.html#questions_patterns"><i class="fa fa-check"></i><b>16.6.1</b> Вопросы</a></li>
<li class="chapter" data-level="16.6.2" data-path="point-patterns.html"><a href="point-patterns.html#tasks_patterns"><i class="fa fa-check"></i><b>16.6.2</b> Упражнения</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Решение проблем</b></span></li>
<li class="chapter" data-level="A" data-path="package-troubles.html"><a href="package-troubles.html"><i class="fa fa-check"></i><b>A</b> Установка пакетов</a><ul>
<li class="chapter" data-level="A.1" data-path="package-troubles.html"><a href="package-troubles.html#package-troubles-standard"><i class="fa fa-check"></i><b>A.1</b> Недоступен стандартный каталог</a></li>
<li class="chapter" data-level="A.2" data-path="package-troubles.html"><a href="package-troubles.html#package-troubles-copy"><i class="fa fa-check"></i><b>A.2</b> Устанавливается, но не копируется</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://istina.msu.ru/profile/tsamsonov/" target="blank">Тимофей Самсонов</a></li>
<li><a href="https://doi.org/10.5281/zenodo.901911"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.901911.svg" title="DOI"></a><li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Визуализация и анализ географических данных на языке R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="kriging" class="section level1">
<h1><span class="header-section-number">Глава 14</span> Геостатистика</h1>
<p><span class="math display">\[\newcommand{\Var}{\operatorname{Var}}
\newcommand{\Cov}{\operatorname{Cov}}
\newcommand{\E}{\operatorname{E}}\]</span></p>
<p><a href="https://github.com/tsamsonov/r-geo-course/blob/master/code/14-InterpolationGeostatistics.R">Программный код главы</a></p>
<div id="введение-1" class="section level2">
<h2><span class="header-section-number">14.1</span> Введение</h2>
<p><strong>Геостатистика</strong> — раздел математической статистики, который связан с численным описанием переменных, распределенных в географическом пространстве и, опционально, времени. Наиболее часто инструменты геостатистики используются для решения задачи интерполяции — восстановления сплошного поля распределения случайной величины по ограниченному множеству данных в точках наблюдений. Однако, геостатистика как научная дисциплина существенно шире. Ее первоочередной задачей является статистическое описание пространственных распределений.</p>
<p>В основе геостатистики лежит широко разработанный математический аппарат. Понимание основ этого аппарата является необходимым условием осмысленного примения геостатистических методов на практике. В настоящей главе мы постараемся сформировать у читателя данное понимание, и показать, как геостатистика работает на практике.</p>
<p>Мир геостатистики базируется на фундаментальных понятиях случайной величины, случайной функции и случайного процесса. Рассмотрим эти понятия.</p>
</div>
<div id="базовые-понятия-и-элементы-геостатистики" class="section level2">
<h2><span class="header-section-number">14.2</span> Базовые понятия и элементы геостатистики</h2>
<div id="базовые-понятия" class="section level3">
<h3><span class="header-section-number">14.2.1</span> Базовые понятия</h3>
<p>Отправной точкой геостатистического анализа является конечное множество точек (локаций), в каждой из которых зафиксировано значение некоторой пространственной переменной. Пространственную и атрибутивную составляющую традиционно разделяют на две компоненты, каждая из которых может быть случайной:</p>
<ol style="list-style-type: decimal">
<li>Пространственные локации (точки)
<span class="math display">\[\{p_1, p_2, ..., p_n\}\]</span></li>
<li>Данные в этих локациях
<span class="math display">\[\{Z(p_1), Z(p_2), ..., Z(p_n)\}\]</span></li>
</ol>
<p>Данные в локациях получаются путем измерений значений пространственно распределенной переменной, или вычисления её значения на основе других данных, которые прямо или косвенно (через другие данные) базируются на прямых или дистанционных наблюдениях. Результаты измерений, как и исходные для расчетов данные, как правило, привязаны ко времени и характеризуют состояние среды на определенный момент. Если описываемое явление является динамическим (изменчивым во времени), результаты наблюдений или расчетов для двух разных моментов времени в общем случае будут различны. Эти различия невозможно <em>полностью</em> описать в аналитическом виде, поскольку природные и социально-экономические процессы формируются неопределенно большим числом факторов. Аналогично этому, невозможно и достоверно предсказать значение пространственной переменной в заданный момент времени. Чтобы работать с такими данными, используются понятия <em>случайной величины</em> и <em>случайного процесса</em>.</p>
<blockquote>
<p><strong>Случайной величиной</strong> <span class="math inline">\(Z(w)\)</span> называется функция, которая в результате случайного события <span class="math inline">\(w\)</span> принимает некоторое вещественнозначное значение.</p>
</blockquote>
<p>Например, при анализе температуры водоема в отдельно взятой точке в толще воды случайной величиной (функцией) является собственно температура, а событием — та совокупность физико-химических условий, которая сложилась в данной точке в данный момент измерений и обусловила наблюдаемое значение температуры.</p>
<p>Отметим, что <em>элемент случайности вносится именно событием</em>, которое в природе может быть сформировано сложной и трудно предсказуемой комбинацией факторов, в то время как <em>случайная величина уже связана с событием некоторой зависимостью</em>, которую можно описать с помощью аналитических или эмпирических формул.</p>
<p>Случайность можно наблюдать не только в точке, но и по пространству. Например, уровень шума, формируемый автотранспортом в открытой городской среде, меняется непрерывно, и его можно измерить в каждой точке. При этом пространственное распределение величины этого уровня будет в каждый момент времени зависеть от случайного события — размещения автомобилей и уровня шума, производимого каждым из них. Городская среда оказывается полностью заполнена шумовым эфиром, густота которого неодинакова в пространстве и времени. Перемещаясь из точки в точку или ожидая последующего момента времени, находясь в одной точке, мы будем наблюдать разный уровень шума. Состояние этого шумового эфира как единого целого является <em>случайным процессом</em>.</p>
<p>Введем общее понятие случайного процесса:</p>
<blockquote>
<p><strong>Случайный процесс</strong> это семейство случайных величин, индексированных некоторым параметром <span class="math inline">\(t\)</span></p>
</blockquote>
<p>Наиболее часто анализируются одномерные случайные процессы, в которых <span class="math inline">\(t\)</span> — это время. Классическим примером такого процесса является количество покупателей, находящихся в магазине.</p>
<p>Пространственная статистика изучает случайные процессы, в которых <span class="math inline">\(t\)</span> — это координата точки (обычно на плоскости). Такие процессы характеризуются следующими особенностями:</p>
<ul>
<li><p>в каждой точке <span class="math inline">\(p_i\)</span> существует некоторая <em>случайная величина</em> <span class="math inline">\(Z(p_i)\)</span> — <strong>сечение случайного процесса</strong></p></li>
<li><p>при изменении точки <span class="math inline">\(p_i\)</span> наблюдаемое значение случайного процесса меняется случайным образом, поскольку определяется оно не только местоположением, но и заранее неизвестным случайным событием.</p></li>
</ul>
<p>Для описания случайных процессов в пространстве необходимо сформировать базовую математическую модель, а также определить ее свойства.</p>
</div>
<div id="случайный-процесс-в-пространстве-и-его-моменты" class="section level3">
<h3><span class="header-section-number">14.2.2</span> Случайный процесс в пространстве и его моменты</h3>
<p>Пусть <span class="math inline">\(p \in \mathbb{R}^k\)</span> — точка в <span class="math inline">\(k\)</span>-мерном Евклидовом пространстве и <span class="math inline">\(Z(p)\)</span> — <strong>случайная величина</strong> в точке <span class="math inline">\(p\)</span>. Тогда если <span class="math inline">\(p\)</span> меняется в пределах области <span class="math inline">\(D \subset \mathbb{R}^k\)</span> (эта область именуется <em>индексным множеством</em>), то формируется <strong>случайный процесс</strong>:</p>
<p><span class="math display">\[\{Z(p) | p \in D\}\]</span>
Вертикальная черта в соответствии с принятой в теории вероятности нотацией означает <em>условие</em>. То есть, переменная <span class="math inline">\(p\)</span> ограничена областью <span class="math inline">\(D\)</span>.</p>
<p>Результат наблюдения случайного процесса в точках области <span class="math inline">\(D\)</span> является <strong>реализацией</strong> случайного процесса:</p>
<p><span class="math display">\[\{z(p) | p \in D\}\]</span></p>
<blockquote>
<p>В общем случае <span class="math inline">\(D\)</span> и <span class="math inline">\(Z\)</span> случайны и независимы</p>
</blockquote>
<p>Случайный процесс, как и случайную величину, можно описать с помощью статистических моментов, таких как математическое ожидание и дисперсия.</p>
<p><strong>Математическое ожидание</strong> есть наиболее вероятная реализация случайного процесса:</p>
<p><span class="math display">\[\E[Z(p)]=m(p)\]</span></p>
<p>Поясним суть математического ожидания СП на следующем примере:</p>
<ul>
<li>Пусть дан географический регион, в пределах которого рассматривается поле температуры и его временная изменчивость.</li>
<li>В каждый момент времени мы имеем непрерывное поле температуры — реализацию случайного процесса.</li>
<li>Если рассмотреть поведение это поля во временном разрезе (по аналогии с колебаниями волн в пространстве), то получим некое “среднее” поле — математическое ожидаение случайного процесса.</li>
</ul>
<p>Если в приведенном примере температура наблюдается посредством сети метеостанций, то в каждый момент времени реализацию СП можно приблизительно восстановить путем выполнения интерполяции по их данным. Осреднив же данные по времени, и снова проинтерполировав их, получим <em>выборочную среднюю</em> поверхность — оценку мат. ожидания СП.</p>
<p><strong>Дисперсия</strong> есть мера разброса реализаций случайного процесса относительно его математического ожидания:</p>
<p><span class="math display">\[\Var[Z(p)]= \E[Z^2(p)]-m^2(p)\]</span>
Аналогично математическому ожиданию, дисперсия двумерного СП представляет собой <em>поле распределения</em>. Величина этого поля каждой точке равна дисперсии сечения СП в этой точке, то есть дисперсии случайной величины. Так же как и в традиционной статистике, вместо дисперсии в расчетах часто используют среднеквадратическое отклонение, поскольку оно выражено в тех же единицах, что и сама случайная величина:</p>
<p><span class="math display">\[\sigma(p)= \sqrt{\Var[Z(p)]}\]</span></p>
<p>В случае поля температуры можно представить себе объем, ограниченный двумя поверхностями <span class="math inline">\(m(p) + \sigma(p)\)</span> и <span class="math inline">\(m(p) - \sigma(p)\)</span>. Расстояние между этими поверхностями в каждой точке <span class="math inline">\(p\)</span> представляет собой среднеквадратическое отклонение случайного процесса.</p>
<p><strong>Ковариация</strong> — это мера линейной зависимости сечений случайного процесса в двух точках <span class="math inline">\(p_1\)</span> и <span class="math inline">\(p_2\)</span>:</p>
<p><span class="math display">\[\Cov(p_1,p_2) = \Cov[Z(p_1), Z(p_2)] = \E[Z(p_1)Z(p_2)]-m(p_1)m(p_2)\]</span></p>
<blockquote>
<p>Для вычисления ковариации необходимость знать математическое ожидание СП. Это условие выполняется далеко не всегда, что связано с тем что как правило приходится иметь дело только с одной его реализацией.</p>
</blockquote>
<p>Следует обратить внимание на то, что <em>моменты пространственных случайных процессов являются функциями, а не константами</em>, в отличие от моментов случайных величин.</p>
<p>Давать оценку пространственной структуре явления на основе вычисленных моментов с.п. можно при условии, что он удовлетворяет свойствам <strong>стационарности</strong> и <strong>эргодичности.</strong></p>
</div>
</div>
<div id="стационарность-и-эргодичность" class="section level2">
<h2><span class="header-section-number">14.3</span> Стационарность и эргодичность</h2>
<div id="стационарность" class="section level3">
<h3><span class="header-section-number">14.3.1</span> Стационарность</h3>
<p><strong>Стационарность</strong> <em>в строгом смысле</em> означает что функция распределения множества случайных величин для любой комбинации точек <span class="math inline">\({x_1, x_2,...,x_k}\)</span> и любого <span class="math inline">\(k &lt; \infty\)</span> остается неизменной при смещении этой комбинации на произвольный вектор <span class="math inline">\(h\)</span>:</p>
<p><span class="math display">\[P\{Z(x_1)&lt;z_1,...,Z(x_k)&lt;z_k\} = P\{Z(x_1 + h)&lt;z_1,...,Z(x_k + h)&lt;z_k\}\]</span></p>
<ul>
<li><p>Стационарность по другому называют <strong>однородностью в пространстве</strong>, подразумевая что явление ведет себя одинаковым образом в любой точке пространства, как бы повторяет само себя.</p></li>
<li><p>Если СФ стационарна, все ее моменты будут инвариантны относительно сдвигов (то есть будут постоянны), а это означает что для их оценки можно использовать ограниченную в пространстве область.</p></li>
</ul>
<p>В реальности подобного рода «идеальное» поведение встречается крайне редко, поэтому используют более слабое предположение о стационарности второго порядка.</p>
<p>Случайная функция имеет имеет <strong>стационарность второго порядка</strong>, если для любых точек <span class="math inline">\(x\)</span> и <span class="math inline">\(x+h\)</span> в <span class="math inline">\(R^k\)</span></p>
<p><span class="math display">\[\begin{cases}
  \E[Z(x)] = m \\
  \E[(Z(x)-m)(Z(x+h)-m)] = \Cov(h)
\end{cases}\]</span></p>
<p>Данные условия означают, что математическое ожидание СФ постоянно, а ковариация зависит только от вектора <span class="math inline">\(h\)</span> между точками и не зависит от их абсолютного положения.</p>
<p>Если ковариация также не зависит от направления, а только от расстояния между точками, то <span class="math inline">\(h\)</span> вырождается в скаляр, а такая случайная функция является <em>изотропной стационарной</em>.</p>
</div>
<div id="эргодичность" class="section level3">
<h3><span class="header-section-number">14.3.2</span> Эргодичность</h3>
<p>Стационарная случайная функция <span class="math inline">\(Z(x,w)\)</span> называется <strong>эргодической</strong>, если ее среднее по области <span class="math inline">\(V \subset R^k\)</span> сходится к математическому ожиданию <span class="math inline">\(m(w)\)</span> при стремлении <span class="math inline">\(V\)</span> к бесконечности:</p>
<p><span class="math display">\[\lim_{V \rightarrow \infty} \frac{1}{|V|}\int_{V} Z(x,w)dx = m(w),\]</span>
где <span class="math inline">\(|V|\)</span> обозначает <em>меру</em> области <span class="math inline">\(V\)</span> (площадь, объем). Предполагается что сама область <span class="math inline">\(V\)</span> растет во всех направлениях, и предел ее роста не зависит от ее формы.</p>
<blockquote>
<p>Следствием эргодичности является то, что среднее по всем возможным реализациям равно среднему отдельной безграничной в пространстве реализации.</p>
</blockquote>
<p>Смысл эргодичности можно пояснить на следующем примере. Пусть дан кувшин с песком, в котором необходимо определить долю объема, занятую содержимым. Проведем следующий эксперимент:</p>
<ul>
<li>Зафиксируем некоторую точку <span class="math inline">\(x\)</span> в системе отсчета, привязанной к кувшину, и будем его встряхивать бесконечное число раз, каждый раз фиксируя, оказалась ли точка <span class="math inline">\(x\)</span> внутри песчинки (записываем 1) или же попала в свободное между ними пространство (записываем 0)</li>
<li>Из серии подобных экспериментов мы сможем оценить среднее значение индикаторной функции <span class="math inline">\(I(x,w)\)</span>, которое равно вероятности попадания зерна в точку <span class="math inline">\(x\)</span>, и которое не зависит от <span class="math inline">\(x\)</span>.</li>
<li>Эта вероятность и будет равна доли объема кувшина, занятой песком.</li>
</ul>
<p>Аналогичный результат можно получить, если теперь зафиксировать кувшин, а точку <span class="math inline">\(x\)</span> выбирать каждый раз случайным образом. Однако в первом случае берется среднее по реализациям, а во втором среднее по пространству.</p>
</div>
</div>
<div id="геостатистическое-оценивание" class="section level2">
<h2><span class="header-section-number">14.4</span> Геостатистическое оценивание</h2>
<div id="простой-кригинг" class="section level3">
<h3><span class="header-section-number">14.4.1</span> Простой кригинг</h3>
<p>Для оценки в точке <span class="math inline">\(Z_0 = Z(p_0)\)</span> по <span class="math inline">\(N\)</span> измерениям <span class="math inline">\(Z_1, ..., Z_N\)</span> ищутся коэффициенты <span class="math inline">\(\lambda\)</span> следующего выражения:</p>
<p><span class="math display">\[Z^* = \sum_{i} \lambda_i Z_i + \lambda_0,\]</span>
где константа <span class="math inline">\(\lambda_0 = \lambda(p_0)\)</span> и веса <span class="math inline">\(\lambda_i\)</span> подобираются в точке <span class="math inline">\(p_0\)</span> таким образом, что минимизируется среднеквадратическая ошибка:</p>
<p><span class="math display">\[\E[Z^* - Z_0]^2,\]</span>
то есть, математическое ожидание квадрата отклонения оценки от теоретического значения.</p>
<blockquote>
<p>Согласно традиции, принятой в литературе по геостатистике, оценка в точке <span class="math inline">\(p_0\)</span> обозначается звездочкой (<span class="math inline">\(Z^*\)</span>), а истинное (неизвестное) значение нулевым индексом (<span class="math inline">\(Z_0\)</span>).</p>
</blockquote>
<blockquote>
<p>В целях уменьшения количества скобок мы используем нотацию <span class="math inline">\(\operatorname{E}[Z^* - Z_0]^2 = \operatorname{E}\big[(Z^* - Z_0)^2\big]\)</span></p>
</blockquote>
<p>Теоретическое значение <span class="math inline">\(Z_0\)</span>, входящее в формулу ошибки, не известно. Однако, как будет показано далее, его знание и не требуется, поскольку <em>ищется не сам квадрат отклонения, а его математическое ожидание</em>.</p>
<p>Используя соотношение <span class="math inline">\(\Var[X] = \E[X^2] - (\E[X])^2\)</span>, выразим среднюю квадратическую ошибку как:</p>
<p><span class="math display">\[\E[Z^* - Z_0]^2 = \Var[Z^* - Z_0] + \big(\E[Z^* - Z_0]\big)^2\]</span></p>
<p>Поскольку дисперсия нечувствительна к сдвигам, изменение константы <span class="math inline">\(\lambda_0\)</span> влияет только на компоненту <span class="math inline">\(\E[Z^* - Z_0]\)</span>. Приравняем ее нулю:</p>
<p><span class="math display">\[\E[Z^* - Z_0] = \E\Big[\sum_{i} \lambda_i Z_i + \lambda_0 - Z_0\Big] = 0\]</span></p>
<p>Используя свойства математического ожидания, выразим из этого выражения <span class="math inline">\(\lambda_0\)</span>:</p>
<p><span class="math display">\[\lambda_0 = - \E\Big[\sum_{i} \lambda_i Z_i - Z_0\Big] = \E[Z_0] - \sum_{i} \lambda_i \E[Z_i] = m_0 - \sum_i \lambda_i m_i,\]</span></p>
<p>где <span class="math inline">\(m_i\)</span> — теоретически известные значения мат. ожидания случайной функции в точках исходных данных <span class="math inline">\(p_i\)</span>, <span class="math inline">\(m_0\)</span> — теоретически известное мат. ожидание случайной функции в оцениваемой точке <span class="math inline">\(p_0\)</span>.</p>
<p>Имея:</p>
<p><span class="math display">\[Z^* = \sum_{i} \lambda_i Z_i + \lambda_0,\\
\lambda_0 = m_0 - \sum_i \lambda_i m_i,\]</span></p>
<p>Получаем:</p>
<p><span class="math display">\[Z^* = \sum_{i} \lambda_i Z_i + m_0 - \sum_i \lambda_i m_i = m_0 + \sum_{i} \lambda_i (Z_i - m_i)\]</span>
Поскольку математические ожидания <span class="math inline">\(m_0\)</span> и <span class="math inline">\(m_i\)</span> предполагаются известными, величину <span class="math inline">\(Z(p)\)</span> можно заменить величиной <span class="math inline">\(Y(p) = Z(p) - m(p)\)</span> в обеих частях уравнения (это эквивалентно вычитанию известного тренда из исходных измерений):</p>
<p><span class="math display">\[
Z^* = m_0 + \sum_{i} \lambda_i (Z_i - m_i),\\
\underbrace{Z^* - m_0}_{Y^*} = \sum_{i} \lambda_i \underbrace{(Z_i - m_i)}_{Y_i},\\
Y^* =  \sum_{i} \lambda_i Y_i.
\]</span>
Это означает, что оценку <span class="math inline">\(Z^*\)</span> можно заменить оценкой <span class="math inline">\(Y^*\)</span> и прибавлением к ней среднего значения <span class="math inline">\(m_0\)</span>:</p>
<p><span class="math display">\[Z^* = m_0 + \sum_{i} \lambda_i Y_i,\]</span></p>
<p>Обратим внимание на то, что <span class="math inline">\(\E[Y^* - Y_0] = \underbrace{\E[Y^*]}_0 - \underbrace{\E[Y_0]}_0 = 0\)</span> по определению <span class="math inline">\(Y(p)\)</span>. В этом случае также <span class="math inline">\(\lambda_0 = \underbrace{\E[Y_0]}_0 - \sum_{i} \lambda_i \underbrace{\E[Y_i]}_0 = 0\)</span> .</p>
<p>Чтобы не загромождать дальнейшее изложение формулами, примем, что <span class="math inline">\(Z^* := Y^*\)</span>, предполагая, что исходная величина уже центрирована относительно мат. ожидания, и к результату вычислений его надо прибавить.</p>
<p>Поскольку <span class="math inline">\(\E[Z^* - Z_0] = 0\)</span>, среднеквадратическую ошибка будет равна дисперсии:</p>
<p><span class="math display">\[\E[Z^* - Z_0]^2 = \Var[Z^* - Z_0]\]</span>
Выразим дисперсию разностей в терминах статистических моментов исходной функции. Для этого воспользуемся следующими свойствами дисперсии и ковариации:</p>
<ul>
<li><span class="math inline">\(\Var[X + Y] = \Var[X] + \Var[Y] + 2\Cov[X, Y]\)</span>;</li>
<li><span class="math inline">\(\Var[-X] = \Var[X]\)</span>;</li>
<li><span class="math inline">\(\Cov[X, -Y] = -\Cov[X, Y]\)</span>.</li>
</ul>
<p>Используя эти свойства, получаем:</p>
<p><span class="math display">\[\E[Z^* - Z_0]^2 = \Var[Z^* - Z_0] = \Var[Z^*] + \Var[Z_0] - 2\Cov[Z^*, Z_0].\]</span></p>
<p>Чтобы минимизировать данное выражение, необходимо раскрыть содержание трёх его компонент. Для этого нам понадобится следующая теорема, позволяющая выразить ковариацию двух линейных комбинаций случайных величин через ковариацию самих исходных случайных величин:</p>

<div class="theorem">
<p><span id="thm:unnamed-chunk-605" class="theorem"><strong>Теорема 14.1  </strong></span>Пусть <span class="math inline">\(X_1,\ldots, X_n\)</span> случайные величины, а <span class="math inline">\(Y_1 = \sum\limits_{i=1}^n a_i X_i,\; Y_2 = \sum\limits_{j=1}^m b_j X_j\)</span> — их две произвольные линейные комбинации. Тогда:</p>
<span class="math display">\[\Cov[Y_1,Y_2] = \sum\limits_{i=1}^n\sum\limits_{j=1}^m a_i b_j \Cov[X_i,X_j].\]</span>
</div>

<p>Используя результат этой теоремы, а также тот факт, что <span class="math inline">\(\Var[X] = \Cov[X, X]\)</span>, распишем каждую компоненту вышеприведенного выражения:</p>
<ul>
<li><p><span class="math inline">\(\Var[Z^*] = \Cov[Z^*, Z^*] = \Cov\Big[\sum_{i} \lambda_i Z_i, \sum_{j} \lambda_j Z_j\Big] =\\\sum_{i}\sum_{j} \lambda_i \lambda_j \Cov[Z_i, Z_j] = \sum_{i}\sum_{j} \lambda_i \lambda_j \sigma_{ij},\)</span></p></li>
<li><p><span class="math inline">\(\Var[Z_0] = \Cov[Z_0, Z_0] = \sigma_{00},\)</span></p></li>
<li><p><span class="math inline">\(\Cov[Z^*, Z_0] = \Cov\Big[\sum_{i} \lambda_i Z_i, Z_0\Big] = \sum_{i} \lambda_i \Cov[Z_i, Z_0] = \sum_{i} \lambda_i \sigma_{i0},\)</span></p></li>
</ul>
<p>где <span class="math inline">\(\sigma_{ij}\)</span> — ковариация случайных величин в точках <span class="math inline">\(p_i\)</span> и <span class="math inline">\(p_j\)</span>, <span class="math inline">\(\sigma_{i0}\)</span> — ковариация случайных величин в точках <span class="math inline">\(p_i\)</span> и оцениваемой точке <span class="math inline">\(p_0\)</span>, <span class="math inline">\(\sigma_{00}\)</span> — дисперсия в точке <span class="math inline">\(p_0\)</span>.</p>
<p>Используя полученные соотношения, выражение для ошибки</p>
<p><span class="math display">\[\E[Z^* - Z_0]^2 = \Var[Z^*] + \Var[Z_0] - 2\Cov[Z^*, Z_0]\]</span></p>
<p>можно представить следующим образом:</p>
<p><span class="math display">\[\E[Z^* - Z_0]^2 = \sum_{i}\sum_{j} \lambda_i \lambda_j \sigma_{ij} - 2 \sum_{} \lambda_i \sigma_{i0} + \sigma_{00}\]</span></p>
<p>Для нахождения минимума этой квадратичной функции необходимо приравнять нулю ее производные по основной переменной <span class="math inline">\(\lambda\)</span>. Выберем в качестве «жертвы» коэффициенты с индексом <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[\frac{\partial}{\partial \lambda_i} \E[Z^* - Z_0]^2 = 2 \sum_{j} \lambda_j \sigma_{ij} - 2 \sigma_{i0} = 0\]</span></p>
<p>Таким образом, система уравнений <strong>простого кригинга</strong> для точки <span class="math inline">\(Z_0\)</span> имеет вид:</p>
<p><span class="math display">\[\color{red}{\boxed{\color{blue}{\sum_{j} \lambda_j \sigma_{ij} = \sigma_{i0}\color{gray}{,~i = 1,...,N}}}}\]</span></p>
<p>Полученные <strong>уравнения простого кригинга носят чисто теоретический характер</strong>, поскольку предполагают знание ковариационной матрицы <span class="math inline">\(\Sigma = \{\sigma_{ij}\}\)</span> случайного процесса. Тем не менее, на их основе удобно выводить уравнения обычного (ординарного) кригинга, в котором подобное знание уже не требуется.</p>
</div>
<div id="дисперсия-простого-кригинга" class="section level3">
<h3><span class="header-section-number">14.4.2</span> Дисперсия простого кригинга</h3>
<p>Существует возможность оценить в каждой точке не только величину показателя, но также дисперсию оценки (в случае постоянного мат. ожидания — среднеквадратическую ошибку).</p>
<p>Для этого необходимо коэффициенты <span class="math inline">\(\lambda_i\)</span>, полученные из системы уравнения простого кригинга</p>
<p><span class="math display">\[\sum_{j} \lambda_j \sigma_{ij} = \sigma_{i0}\]</span></p>
<p>подставить в выражение среднеквадратической ошибки</p>
<p><span class="math display">\[\Var[Z^* - Z_0] = \sum_{i}\sum_{j} \lambda_i \lambda_j \sigma_{ij} - 2 \sum_{} \lambda_i \sigma_{i0} + \sigma_{00}\]</span></p>
<p>Умножим обе части каждого уравнения простого кригинга на <span class="math inline">\(\lambda_i\)</span> и просуммируем все уравнения по <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[\sum_{j} \lambda_j \sigma_{ij} = \sigma_{i0}~\Bigg|\times \lambda_i\\
\color{red}{\sum_{i}\sum_{j} \lambda_i \lambda_j \sigma_{ij}} = \color{blue}{\sum_{i}\lambda_i\sigma_{i0}}\]</span></p>
<p>Заметим, что левая часть уравнения присутствует в выражении среднеквадратической ошибки:</p>
<p><span class="math display">\[\Var[Z^* - Z_0] = \color{red}{\sum_{i}\sum_{j} \lambda_i \lambda_j \sigma_{ij}} - 2 \sum_{} \lambda_i \sigma_{i0} + \sigma_{00}\]</span></p>
<p>Выполним соответствующую замену <span class="math inline">\(\sum_{i}\sum_{j} \lambda_i \lambda_j \sigma_{ij}\)</span> на <span class="math inline">\(\sum_{i}\lambda_i\sigma_{i0}\)</span>:</p>
<p><span class="math display">\[\Var[Z^* - Z_0] = \color{blue}{\sum_{i}\lambda_i\sigma_{i0}} - 2 \sum_{} \lambda_i \sigma_{i0} + \sigma_{00}\]</span></p>
<p>Отсюда получаем выражение для дисперсии (ошибки) простого кригинга:</p>
<p><span class="math display">\[\color{red}{\boxed{\color{blue}{\sigma_{SK} = \Var[Z^* - Z_0] = \sigma_{00} - \sum_{i}\lambda_i\sigma_{i0}}}}\]</span></p>
</div>
<div id="стационарность-приращений" class="section level3">
<h3><span class="header-section-number">14.4.3</span> Стационарность приращений</h3>
<p>Стационарность второго порядка требует знания математического ожидания для вычисления ковариации.</p>
<p>В ряде случаев оценить математическое ожидание оказывается невозможно (оно может не существовать) или же оно действительно оказывается непостоянным.</p>
<p>Тогда пользуются еще более мягкой формой стационарности <strong>стационарностью приращений</strong>, при которой стационарной предполагается не сама с.ф. <span class="math inline">\(Z(x)\)</span>, а производная от нее функция:</p>
<p><span class="math display">\[Y_h(x) = Z(x+h)-Z(x)\]</span></p>
<p>Функция <span class="math inline">\(Z(x)\)</span>, обладающая таким свойством, называется подчиняющейся <em>внутренней гипотезе</em>.</p>
<p>У функции <span class="math inline">\(Y_h(x) = Z(x+h)-Z(x)\)</span> должны существовать математическое ожидание и дисперсия <strong>приращений</strong>:</p>
<p><span class="math display">\[\begin{cases}
\E[Z(x+h)-Z(x)] = \langle a,h \rangle \\
\Var[Z(x+h)-Z(x)] = 2\gamma(h)
\end{cases}\]</span></p>
<ul>
<li><p><span class="math inline">\(\langle a,h \rangle\)</span> обозначает линейный тренд <span class="math inline">\(a\)</span> при заданном векторе <span class="math inline">\(h\)</span> (<em>математическое ожидание разности значений</em>), который варажется через скалярное произведение: <span class="math inline">\(\langle a,h \rangle = \sum_i a_i h_i\)</span></p></li>
<li><p><span class="math inline">\(\gamma(h)\)</span> — дисперсия приращений, называемая <em>вариограммой</em></p></li>
</ul>
<p>Если процесс подчиняется гипотезе стационарности второго рода <span class="math inline">\(\E[Z(x)] = m\)</span>, то <span class="math inline">\(\E[Z(x+h)-Z(x)] = \E[Y_h(x)] = 0\)</span> и вариограмму можно выразить следующим образом:</p>
<p><span class="math display">\[2\gamma(h) = \Var[Z(x+h)-Z(x)] = \Var[Y_h(x)] \\=\E\big[Y_h(x)\big]^2 - \Big(\E\big[Y_h(x)\big]\Big)^2 \\=\E\big[Y_h(x)\big]^2 = \E\big[Z(x+h)-Z(x)\big]^2\]</span></p>
<p>Таким образом, наиболее распространенная в геостатистике гипотеза подчиняется следующим условиям:</p>
<p><span class="math display">\[\begin{cases}
\E\big[Z(x)\big] = m\\
\E\big[Z(x+h)-Z(x)\big] = 0 \\
\E\big[Z(x+h)-Z(x)\big]^2 = 2\gamma(h)
\end{cases}\]</span></p>
<ul>
<li><p>Эти условия позволяют избавиться от необходимости знания среднего значения и дисперсии случайной функции и использовать для вычислений вариограмму.</p></li>
<li><p>Чтобы модифицировать соответствующим образом уравнения простого кригинга, необходимо знать связь между ковариацией и вариограммой.</p></li>
</ul>
</div>
<div id="переход-от-ковариации-к-вариограмме" class="section level3">
<h3><span class="header-section-number">14.4.4</span> Переход от ковариации к вариограмме</h3>
<div id="предварительные-условия-2" class="section level4">
<h4><span class="header-section-number">14.4.4.1</span> Предварительные условия</h4>
<p>Для того чтобы функция могла считаться ковариацией, необходимо, чтобы дисперсия, вычисленная на ее основе, была положительной:</p>
<p><span class="math display">\[\Var \Bigg[\sum_{i=1}^N \lambda_i Z(x_i)\Bigg] = \Cov\Bigg[\sum_{i=1}^N \lambda_i Z(x_i), \sum_{j=1}^N \lambda_j Z(x_j)\Bigg] = \\=\sum_{i=1}^N \sum_{j=1}^N \lambda_i \lambda_j \Cov\big[Z(x_i), Z(x_j)\big] \\= \sum_{i=1}^N \sum_{j=1}^N \lambda_i \lambda_j C(x_j - x_i)\]</span></p>
<blockquote>
<p>Функция <span class="math inline">\(C(h)\)</span>, для которой при любых значениях <span class="math inline">\(N\)</span>, <span class="math inline">\(x_i\)</span> и <span class="math inline">\(\lambda_i\)</span> выражение <span class="math inline">\(\sum_{i=1}^N \sum_{j=1}^N \lambda_i \lambda_j C(x_j - x_i)\)</span> принимает неотрицательные значения, называется <strong>положительно определенной</strong>.</p>
</blockquote>
<p>Если функция отвечает внутренней гипотезе, нет гарантий, что ее ковариация существует и ограничена. В этом случае можно оценить дисперсию суммы случайных функций через дисперсию приращений, наложив дополнительное условие <span class="math inline">\(\sum_{i=1}^N \lambda_i = 0\)</span>. Учитывая что <span class="math inline">\(\sum_{i=1}^N \lambda_i Z(x_0) = Z(x_0) \sum_{i=1}^N \lambda_i = 0\)</span>, имеем:</p>
<p><span class="math display">\[\sum_{i=1}^N \lambda_i Z(x_i) = \sum_{i=1}^N \lambda_i Z(x_i) - \sum_{i=1}^N \lambda_i Z(x_0) = \sum_{i=1}^N \lambda_i \big[Z(x_i) - Z(x_0)\big]\]</span></p>
<blockquote>
<p>Линейные комбинации, отвечающие условию <span class="math inline">\(\sum_{i=1}^N \lambda_i = 0\)</span>, называются <strong>допустимыми линейными комбинациями</strong>.</p>
</blockquote>
</div>
<div id="вывод-выражения-для-ковариации-через-вариограмму" class="section level4">
<h4><span class="header-section-number">14.4.4.2</span> Вывод выражения для ковариации через вариограмму</h4>
<p>Рассмотрим ковариацию двух линейных комбинаций с.ф.:</p>
<p><span class="math display">\[\Cov \Bigg[\sum_{i=1}^N \lambda_i Z(x_i), \sum_{j=1}^M \mu_j Z(x_j) \Bigg] = \sum_{i=1}^N \sum_{j=1}^M \lambda_i \mu_j C(x_j - x_i)\]</span></p>
<p>Используя правило <span class="math inline">\(\Cov[X + \alpha, Y + \beta] = \Cov[X, Y]\)</span>, введем условное начало координат:</p>
<p><span class="math display">\[\sum_{i=1}^N \sum_{j=1}^M \lambda_i \mu_j C(x_j - x_i) =\\
=\sum_{i=1}^N \sum_{j=1}^M \lambda_i \mu_j \Cov \big[Z(x_i) - Z(x_0), Z(x_j) - Z(x_0)\big]\]</span></p>
<p>Распишем ковариацию через математические ожидания, учитывая, что, согласно гипотезе, <span class="math inline">\(\E\big[Z(x+h)-Z(x)\big] = 0\)</span>:</p>
<p><span class="math display">\[\Cov \big[Z(x_i) - Z(x_0), Z(x_j) - Z(x_0)\big] =\\
= \E\big[Z_i - Z_0\big]\big[Z_j - Z_0\big] - \E\big[Z_i - Z_0\big] E\big[Z_j - Z_0\big] = \\
= \E\big[Z_i - Z_0\big]\big[Z_j - Z_0\big]\]</span></p>
<p>Обратим внимание, что произведение приращений можно выразить через квадраты приращений:</p>
<p><span class="math display">\[\color{blue}{(Z_j - Z_i)^2} = \big[(Z_j - Z_0) - (Z_i - Z_0)\big]^2 = \\ = \color{blue}{(Z_i - Z_0)^2} - 2\color{red}{(Z_i - Z_0)(Z_j - Z_0)} + \color{blue}{(Z_j - Z_0)^2}\]</span></p>
<p>Имеем:</p>
<p><span class="math display">\[ (Z_i - Z_0)(Z_j - Z_0) = \frac{1}{2} \Big[(Z_i - Z_0)^2 + (Z_j - Z_0)^2 - (Z_j - Z_i)^2\Big]\]</span>
Учитывая, что <span class="math inline">\(\E\big[Z(x+h)-Z(x)\big]^2 = 2\gamma(h)\)</span>, подставим это выражение в формулу вычисления ковариации:</p>
<p><span class="math display">\[\Cov \big[Z(x_i) - Z(x_0), Z(x_j) - Z(x_0)\big] = \E\big[Z_i - Z_0\big]\big[Z_j - Z_0\big] = \\
= \frac{1}{2} \E \Big[(Z_i - Z_0)^2 + (Z_j - Z_0)^2 - (Z_j - Z_i)^2\Big] = \\
= \gamma(x_i - x_0) + \gamma(x_j - x_0) - \gamma(x_j - x_i)\]</span></p>
<p>Подставим полученное выражение в двойную сумму:</p>
<p><span class="math display">\[\sum_{i=1}^N \sum_{j=1}^M \lambda_i \mu_j \Cov \big[Z(x_i) - Z(x_0), Z(x_j) - Z(x_0)\big] = \\ 
= \sum_{i=1}^N \sum_{j=1}^M \lambda_i \mu_j \big[\gamma(x_i - x_0) + \gamma(x_j - x_0) - \gamma(x_j - x_i)\big] = \\
= \underbrace{\color{red}{\sum_{i=1}^N \sum_{j=1}^M \lambda_i \mu_j \gamma(x_i - x_0)}}_0 + \underbrace{\color{blue}{\sum_{i=1}^N \sum_{j=1}^M \lambda_i \mu_j \gamma(x_j - x_0)}}_0 - \sum_{i=1}^N \sum_{j=1}^M \lambda_i \mu_j \gamma(x_j - x_i) = \\
= - \sum_{i=1}^N \sum_{j=1}^M \lambda_i \mu_j \gamma(x_j - x_i),\]</span></p>
<p>Компоненты суммы, содержащие <span class="math inline">\(x_0\)</span>, будут равны нулю, поскольку они содержат коэффициенты с индексами, не участвующими в вычислении <span class="math inline">\(\gamma\)</span> — суммирование по этим индексам можно вынести наружу:</p>
<ul>
<li><span class="math inline">\(\color{red}{\sum_{i=1}^N \sum_{j=1}^M \lambda_i \mu_j \gamma(x_i - x_0)} = \underbrace{\sum_{j=1}^M \mu_j}_0 \sum_{i=1}^N \lambda_i \gamma(x_i - x_0) = 0;\)</span></li>
<li><span class="math inline">\(\color{blue}{\sum_{i=1}^N \sum_{j=1}^M \lambda_i \mu_j \gamma(x_j - x_0)} = \underbrace{\sum_{i=1}^N \lambda_i}_0 \sum_{j=1}^M \mu_i \gamma(x_j - x_0) = 0,\)</span></li>
</ul>
<p>где соотношения <span class="math inline">\(\sum_{i=1}^N \lambda_i = 0\)</span> и <span class="math inline">\(\sum_{j=1}^M \mu_j = 0\)</span> соблюдаются в силу того, что мы работаем с <em>допустимыми линейными комбинациями</em>.</p>
<p>Согласно полученным выкладкам у нас появляется возможность сравнить выражение для ковариации двух линейных комбинаций случайных величин для стационарного случая и внутренней гипотезы:</p>
<p><span class="math display">\[\Cov \Bigg[\sum_{i=1}^N \lambda_i Z(x_i), \sum_{j=1}^M \mu_j Z(x_j) \Bigg] = \underbrace{\sum_{i=1}^N \sum_{j=1}^M \lambda_i \mu_j \sigma(x_j - x_i)}_{\texttt{стационарный случай}} = \underbrace{- \sum_{i=1}^N \sum_{j=1}^M \lambda_i \mu_j \gamma(x_j - x_i)}_{\texttt{внутренняя гипотеза}}\]</span></p>
<p>Видно, данные выражения отличаются лишь знаком (в случае внутренней гипотезы появляется минус) и вычисляемой функцией (ковариация заменяется на вариограмму при переходе к внутренней гипотезе).</p>
<p>Таким образом, получаем важнейший вывод, необходимый для решения системы уравнений обычного кригинга, рассматриваемых в следующем параграфе:</p>
<blockquote>
<p><strong>При соблюдении внутренней гипотезы в уравнениях кригинга можно принять</strong> <span class="math inline">\(\sigma_{ij} = -\gamma_{ij}\)</span></p>
</blockquote>
<p>Следствием этого также является то, что дисперсия <em>допустимой линейной комбинации</em> может быть выражена через вариограмму:</p>
<p><span class="math display">\[\Var \Bigg[\sum_{i=1}^N \lambda_i Z(x_i)\Bigg] = - \sum_{i=1}^N \sum_{j=1}^N \lambda_i \lambda_j \gamma(x_j - x_i)\]</span></p>
<p>Функция <span class="math inline">\(G(h)\)</span>, для которой при условии и <span class="math inline">\(\sum_{i=1}^N \lambda_i = 0\)</span> выражение <span class="math inline">\(\sum_{i=1}^N \sum_{j=1}^N \lambda_i \lambda_j G(x_j - x_i)\)</span> принимает неотрицательные значения, называется <strong>условно положительно определенной</strong>.</p>
<blockquote>
<p><span class="math inline">\(-\gamma(h)\)</span> — условно положительно определенная ф.</p>
</blockquote>
</div>
</div>
<div id="обычный-кригинг" class="section level3">
<h3><span class="header-section-number">14.4.5</span> Обычный кригинг</h3>
<p>Пусть дано неизвестное среднее <span class="math inline">\(m(x) = a_0\)</span>. Необходимо произвести линейную оценку <span class="math inline">\(Z^* = \sum_{i} \lambda_i Z_i + \lambda_0\)</span>. Выразим среднюю квадратическую ошибку:</p>
<p><span class="math display">\[\E\big[(Z^* - Z_0)^2\big] = \Var[Z^* - Z_0] + \big(\E[Z^* - Z_0]\big)^2 =\\
= \Var[Z^* - Z_0] + \Bigg[\E\bigg[\sum_{i} \lambda_i Z_i + \lambda_0\bigg] - \E\big[Z_0\big] \Bigg]^2 =\\= \Var[Z^* - Z_0] + \Bigg[\underbrace{\E[\lambda_0]}_{\lambda_0} + \sum_{i} \lambda_i \underbrace{\E\big[Z_i\big]}_{a_0} - \underbrace{\E\big[Z_0\big]}_{a_0} \Bigg]^2 =\\= \Var[Z^* - Z_0] + \Bigg[\lambda_0 + \bigg(\sum_i \lambda_i - 1 \bigg) a_0 \Bigg]^2\]</span></p>
<ul>
<li>Только компонента сдвига <span class="math inline">\(\E[Z^* - Z_0]\)</span> содержит <span class="math inline">\(\lambda_0\)</span>, однако, в отличие от случая простого кригинга, мы не можем минимизировать ее, не зная <span class="math inline">\(a_0\)</span>.</li>
<li>Единственный способ избавиться от <span class="math inline">\(a_0\)</span> заключается в том, чтобы наложить дополнительное условие <span class="math inline">\(\sum \lambda_i - 1 = 0\)</span></li>
</ul>
<p>Минимизируем ранее введенную функцию ошибки:</p>
<p><span class="math display">\[\Var[Z^* - Z_0] = \sum_{i}\sum_{j} \lambda_i \lambda_j \sigma_{ij} - 2 \sum_{} \lambda_i \sigma_{i0} + \sigma_{00}\]</span></p>
<p>Для этого, с учетом дополнительного условия <span class="math inline">\(\sum \lambda_i -1 = 0\)</span> применим метод множителей Лагранжа и построим вспомогательную функцию:</p>
<p><span class="math display">\[Q = \Var[Z^* - Z_0] + 2\mu \bigg(\sum_i \lambda_i - 1 \bigg),\]</span></p>
<p>где <span class="math inline">\(\mu\)</span> – неизвестный множитель Лагранжа.</p>
<p>Для минимизации функции приравняем нулю ее частные производные:</p>
<p><span class="math display">\[\begin{cases}\frac{\partial Q}{\partial \lambda_i} = 2 \sum_j \lambda_j \sigma_{ij} - 2 \sigma_{i0} + 2\mu = 0,~i = 1,...,N,\\
\frac{\partial Q}{\partial \mu} = 2\bigg(\sum_i \lambda_i - 1 \bigg) = 0
\end{cases}\]</span></p>
<p>Имеем <span class="math inline">\(N + 1\)</span> уравнений с <span class="math inline">\(N + 1\)</span> неизвестными:</p>
<p><span class="math display">\[\begin{cases}\sum_j \lambda_j \sigma_{ij} + \mu = \sigma_{i0},~i = 1,...,N,\\
\sum_i \lambda_i = 1
\end{cases}\]</span></p>
<p>Заменяя ковариацию на вариограмму, согласно выводу, полученному в предыдущем параграфе, получаем <strong>систему уравнений обычного кригинга</strong>:</p>
<p><span class="math display">\[\color{red}{\boxed{\color{blue}{\begin{cases}\sum_j \lambda_j \gamma_{ij} - \mu = \gamma_{i0},\color{gray}{~i = 1,...,N,}\\
\sum_i \lambda_i = 1
\end{cases}}}}\]</span></p>
<blockquote>
<p>Обычный (или ординарный) кригинг — наиболее часто используемый геостатистический метод интерполяции.</p>
</blockquote>
</div>
<div id="дисперсия-обычного-кригинга" class="section level3">
<h3><span class="header-section-number">14.4.6</span> Дисперсия обычного кригинга</h3>
<p>Вывод формулы для оценки дисперсии обычного кригинга выполняется аналогично случаю простого кригинга. Умножим <span class="math inline">\(N\)</span> первых уравнений на <span class="math inline">\(\lambda_i\)</span>, просуммируем их по <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[\sum_j \lambda_j \gamma_{ij} - \mu = \gamma_{i0}~\Bigg|\times \lambda_i\]</span></p>
<p>Учтя дополнительное условие <span class="math inline">\(\sum_i \lambda_i = 1\)</span>, получаем выражение для оценки дисперсии (ошибки) обычного кригинга:</p>
<p><span class="math display">\[\color{red}{\boxed{\color{blue}{\sigma_{OK} = Var[Z^* - Z_0] = \sum_{i}\lambda_i\gamma_{i0} - \mu}}}\]</span></p>
</div>
<div id="универсальный-кригинг" class="section level3">
<h3><span class="header-section-number">14.4.7</span> Универсальный кригинг</h3>
<p>В методе универсального кригинга осуществляется декомпозиция переменной <span class="math inline">\(Z(x)\)</span> в виде следующей суммы:</p>
<p><span class="math display">\[Z(x) = m(x) + Y(x)\]</span></p>
<ul>
<li><p><span class="math inline">\(m(x)\)</span> — <strong>дрифт</strong> (<em>drift</em>), гладкая детерминированная функция, описывающая <em>систематическую</em> составляющую пространственной изменчивости явления;</p></li>
<li><p><span class="math inline">\(Y(x)\)</span> - <strong>остаток</strong> (<em>residual</em>), случайная функция с нулевым математическим ожиданием, описывающая <em>случайную</em> составляющую пространственной изменчивости явления;</p></li>
</ul>
<blockquote>
<p>Декомпозиция любого явления на дрифт и остаток зависит от масштаба рассмотрения явления.</p>
</blockquote>
<p>Метод универсального кригинга используется, когда математическое ожидание случайного процесса непостоянно по пространству. Это позволяет интерполировать данные, в которых присутствует тренд.</p>
<p>В предположении, что м.о. имеет функциональную зависимость от других процессов в точке <span class="math inline">\(x\)</span>, вводится следующая модель:</p>
<p><span class="math display">\[m(x) = \sum_{k=0}^{K} a_k f^k(x),\]</span></p>
<p>где <span class="math inline">\(f^k(x)\)</span> — известные <em>базисные функции</em>, а <span class="math inline">\(a_k\)</span> — фиксированные для точки <span class="math inline">\(x\)</span>, но неизвестные коэффициенты.</p>
<ul>
<li><p>Обычно первая базисная функция при <span class="math inline">\(k = 0\)</span> представляет собой константу, равную 1. Это позволяет включить в модель случай постоянного м.о.</p></li>
<li><p>Если среднее зависит только от местоположения, то оставшиеся функции <span class="math inline">\(f^k(x), k &gt; 0\)</span>, как правило, представляют собой одночлены от координат (например, для двумерного случая <span class="math inline">\(f^2(p) = x^2 + y^2\)</span>)</p></li>
<li><p>Коэффициенты <span class="math inline">\(a_k\)</span> могут меняться в зависимости от <span class="math inline">\(x\)</span>, но обязательно медленно, чтобы их можно было считать постоянными в окрестности <span class="math inline">\(x\)</span>.</p></li>
</ul>
<p>В качестве дрифта <span class="math inline">\(m(x)\)</span> можно использовать не только функцию от местоположения, но также значения внешней переменной — <strong>ковариаты</strong>.</p>
<p>Например, количество осадков можно связать с высотой точки <span class="math inline">\(H(x)\)</span> следующей моделью:</p>
<p><span class="math display">\[Z(x) = a_0 + a_1 H(x) + Y(x)\]</span></p>
<p>С статистической точки зрения это линейная регрессия, в которой остатки коррелированы (автокоррелированы).</p>
<blockquote>
<p>В литературе данный метод называют также <strong>регрессионным кригингом</strong> (<em>regression kriging</em>), а оценка дрифта — <strong>пространственной регрессией</strong> (<em>spatial regression</em>).</p>
</blockquote>
<p>Для вывода уравнений рассмотрим среднеквадратическую ошибку:
<span class="math display">\[\E[Z^* - Z_0]^2 = \Var[Z^* - Z_0] + \big(\E[Z^* - Z_0]\big)^2\]</span></p>
<p>Используя введенную модель дрифта <span class="math inline">\(m(x) = \sum_{k=0}^{K} a^k f^k(x)\)</span> распишем выражение для мат.ожидания приращений:</p>
<p><span class="math display">\[\E[Z^* - Z_0] = \E[Z^*\big] - \E[Z_0] = \\
\sum_i \lambda_i \sum_k a_k f_i^k - \sum_k a_k f_0^k = \sum_k a_k \Bigg(\sum_i \lambda_i f_i^k - f_0^k\Bigg)\]</span></p>
<p>Чтобы минимизировать <span class="math inline">\(\E[Z^* - Z_0]\)</span> независимо от коэффициентов <span class="math inline">\(a_k\)</span>, достаточно в вышеприведенной формуле приравнять нулю выражение в скобках. Отсюда имеем:</p>
<p><span class="math display">\[\sum_i \lambda_i f_i^k = f_0^k,~k = 0, 1, ..., K.\]</span></p>
<p>Эти условия называются <strong>условиями универсальности</strong>. Отсюда идет название метода — <em>универсальный кригинг</em></p>
<blockquote>
<p>Условия универсальности гаранируют, что оценка <span class="math inline">\(Z^*\)</span> является <strong>несмещенной</strong> для <em>любых</em> значений <span class="math inline">\(a_k\)</span>.</p>
</blockquote>
<p>Минимизируем ранее введенную функцию ошибки:</p>
<p><span class="math display">\[\Var[Z^* - Z_0] = \sum_{i}\sum_{j} \lambda_i \lambda_j \sigma_{ij} - 2 \sum_{} \lambda_i \sigma_{i0} + \sigma_{00}\]</span></p>
<p>Для этого, с учетом дополнительного условия <span class="math inline">\(\sum_i \lambda_i f_i^k = f_0^k\)</span> применим метод множителей Лагранжа и построим вспомогательную функцию:</p>
<p><span class="math display">\[Q = \Var[Z^* - Z_0] + 2 \sum_{k=0}^K \mu_k \Bigg[ \sum_i \lambda_i f_i^k - f_0^k\Bigg],\]</span></p>
<p>где <span class="math inline">\(\mu_k,~k = 0, 1, ..., K\)</span> представляют <span class="math inline">\(K + 1\)</span> дополнительных неизвестных, множители Лагранжа.</p>
<p>Для минимизации функции приравняем нулю ее частные производные:</p>
<p><span class="math display">\[\begin{cases}\frac{\partial Q}{\partial \lambda_i} = 2 \sum_j \lambda_j \sigma_{ij} -2 \sigma_{i0} + 2 \sum_k \mu_k f_i^k = 0,\color{gray}{~i = 1,...,N,}\\
\frac{\partial Q}{\partial \mu} = 2\bigg[\sum_i \lambda_i f_i^k - f_0^k \bigg] = 0\color{gray}{,~k = 0, 1,..., K.}
\end{cases}\]</span></p>
<p>Имеем систему из <span class="math inline">\(N + K + 1\)</span> уравнений с <span class="math inline">\(N + K + 1\)</span> неизвестными:</p>
<p><span class="math display">\[\begin{cases}\sum_j \lambda_j \sigma_{ij} + \sum_k \mu_k f_i^k = \sigma_{i0},~i = 1,...,N,\\
\sum_i \lambda_i f_i^k = f_0^k,~k = 0, 1,..., K.
\end{cases}\]</span></p>
<p>Заменяя ковариацию на вариограмму, получаем <strong>систему уравнений универсального кригинга</strong>:</p>
<p><span class="math display">\[\color{red}{\boxed{\color{blue}{\begin{cases}\sum_j \lambda_j \gamma_{ij} - \sum_k \mu_k f_i^k = \gamma_{i0},\color{gray}{~i = 1,...,N,}\\
\sum_i \lambda_i f_i^k = f_0^k\color{gray}{,~k = 0, 1,..., K.}
\end{cases}}}}\]</span></p>
</div>
<div id="дисперсия-универсального-кригинга" class="section level3">
<h3><span class="header-section-number">14.4.8</span> Дисперсия универсального кригинга</h3>
<p>Вывод формулы для оценки дисперсии универсального кригинга выполняется аналогично случаю обычного кригинга. Умножим <span class="math inline">\(N\)</span> первых уравнений на <span class="math inline">\(\lambda_i\)</span>, просуммируем их по <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[\sum_j \lambda_j \gamma_{ij} - \sum_k \mu_k f_i^k = \gamma_{i0} ~ \Bigg|\times \lambda_i\]</span></p>
<p>Учтя дополнительное условие <span class="math inline">\(\sum_i \lambda_i f_i^k = f_0^k\)</span>, получаем выражение для оценки дисперсии (ошибки) универсального кригинга:</p>
<p><span class="math display">\[\color{red}{\boxed{\color{blue}{\sigma_{UK} = \E[Z^* - Z_0]^2 = \sum_{i}\lambda_i\gamma_{i0} - \sum_k \mu_k f_0^k}}}\]</span></p>
</div>
<div id="кросс-валидация" class="section level3">
<h3><span class="header-section-number">14.4.9</span> Кросс-валидация</h3>
<p>Значение переменной <span class="math inline">\(Z(x)\)</span> оценивается в каждой точке <span class="math inline">\(x_i\)</span> по данным в соседних точках <span class="math inline">\(Z(x_j), ~ j \neq i\)</span> как если бы <span class="math inline">\(Z(x_i)\)</span> было неизвестно.</p>
<p>В каждой точке вычисляется оценка кригинга <span class="math inline">\(Z_{-i}^*\)</span> и соответствующая дисперсия кригинга <span class="math inline">\(\sigma_{Ki}^2\)</span>. Поскольку значение <span class="math inline">\(Z_i = Z(x_i)\)</span> известно, мы можем вычислить:</p>
<ul>
<li><strong>Ошибку кригинга</strong> <span class="math inline">\(E_i = Z_{-i}^* - Z_i\)</span></li>
<li><strong>Стандартизированную ошибку</strong> <span class="math inline">\(e_i = E_i / \sigma_{Ki}\)</span></li>
</ul>
<p>Если <span class="math inline">\(\gamma(h)\)</span> — теоретическая вариограмма, то <span class="math inline">\(E_i = Z_{-i}^* - Z_i\)</span> — случайная величина с м.о. = <span class="math inline">\(0\)</span> и дисперсией <span class="math inline">\(\sigma_{K_i}^2\)</span>, а <span class="math inline">\(e_i\)</span> имеет м.о. = <span class="math inline">\(0\)</span> и дисперсию, равную <span class="math inline">\(1\)</span>.</p>
<p>Стандартно анализируются следующие карты и графики:</p>
<ul>
<li><p><em>Карта стандартизированных ошибок</em> <span class="math inline">\(e_i\)</span>. Стационарность ошибок, отсутствие эффекта пропорциональности.</p></li>
<li><p><em>Гистограмма стандартизированных ошибок</em> <span class="math inline">\(e_i\)</span>. Нормальность распределения, отсутствие аномалий.</p></li>
<li><p><em>Диаграмма рассеяния</em> <span class="math inline">\((Z_{-i}^*, Z_i)\)</span>. Сглаживающий эффект, соответствие оценки и реального значения.</p></li>
<li><p><em>Диаграмма рассеяния</em> <span class="math inline">\((Z_{-i}^*, e_i)\)</span>. Независимость (ортогональность) оценки и ошибки.</p></li>
</ul>
</div>
<div id="вариограмма" class="section level3">
<h3><span class="header-section-number">14.4.10</span> Вариограмма</h3>
<p><strong>Вариограмма</strong> <em>(полувариограмма)</em> дисперсия разности значений в точках как функция от их взаимного положения:</p>
<p><span class="math display">\[\gamma (h) = \gamma(x, x + h) = \E\big[Z(x + h)-Z(x)\big]^2\]</span></p>
<p>Для <span class="math inline">\(N\)</span> точек, разделенных вектором <span class="math inline">\(\mathbf{h}\)</span>:</p>
<p><span class="math display">\[\gamma(h) = \frac{1}{2N(h)}\sum_{i=1}^{N(\mathbf{h})} \big[Z(x_i) - Z(x_i + h)\big]^2\]</span></p>
<p>Свойства вариограммы:</p>
<ul>
<li><p>Вариограмма симметрична:</p>
<p><span class="math display">\[\gamma(x) = \gamma(-x)\]</span></p></li>
<li><p>Вариограмма связана с дисперсией:</p>
<p><span class="math display">\[\gamma(\infty) = \Var\big[ Z(x) \big]\]</span></p></li>
<li><p>Вариограмма связана с ковариацией:</p>
<p><span class="math display">\[\gamma(h) = \Var\big[ Z(x) \big] - C(h)\]</span></p></li>
<li><p>Вариограмма чувствительна к аномальным значениям (по причине второй степени)</p></li>
</ul>
</div>
<div id="модели-вариограмм" class="section level3">
<h3><span class="header-section-number">14.4.11</span> Модели вариограмм</h3>
<p>В уравнениях кригинга нельзя использовать эмпирическую вариограмму. Это связано с тем, что вывод этих уравнений опирается на предположение, что вариограмма представляет собой <em>условно положительно определенную функцию</em>. Поэтому следующим шагом после вычисления эмпирической вариограммы является подбор теоретической модели, которая наилучшим образом аппроксимирует эмпирическу функцию, и при этом отвечает требованию условной положительной определенности. Рассмотрим несколько распространенных на практике моделей.</p>
</div>
<div id="сферическая-модель" class="section level3">
<h3><span class="header-section-number">14.4.12</span> Сферическая модель</h3>
<p><span class="math display">\[\gamma(h) = \begin{cases}
  c_0 + c\Big[\frac{3h}{2a} - \frac{1}{2}\big(\frac{h}{a}\big)^3\Big], &amp; h \leq a; \\
  c_0 + c, &amp; h &gt; a.
\end{cases}\]</span></p>
<p><span class="math display">\[\gamma(a) = \Var\big[Z(p)\big] = c_0 + c\]</span></p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="kriging.html#cb645-1"></a>n =<span class="st"> </span><span class="dv">60</span></span>
<span id="cb645-2"><a href="kriging.html#cb645-2"></a>a =<span class="st"> </span><span class="dv">40</span></span>
<span id="cb645-3"><a href="kriging.html#cb645-3"></a>h =<span class="st"> </span><span class="dv">0</span><span class="op">:</span>n</span>
<span id="cb645-4"><a href="kriging.html#cb645-4"></a></span>
<span id="cb645-5"><a href="kriging.html#cb645-5"></a>tab =<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tibble</span>(</span>
<span id="cb645-6"><a href="kriging.html#cb645-6"></a>  <span class="dt">h =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">60</span>,</span>
<span id="cb645-7"><a href="kriging.html#cb645-7"></a>  <span class="dt">gamma =</span> <span class="kw">c</span>(<span class="dv">3</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">0</span><span class="op">:</span>(a<span class="dv">-1</span>)) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>a) <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">0</span><span class="op">:</span>(a<span class="dv">-1</span>) <span class="op">/</span><span class="st"> </span>a)<span class="op">^</span><span class="dv">3</span>, <span class="kw">rep</span>(<span class="dv">1</span>, n<span class="op">-</span>a<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb645-8"><a href="kriging.html#cb645-8"></a>)</span>
<span id="cb645-9"><a href="kriging.html#cb645-9"></a></span>
<span id="cb645-10"><a href="kriging.html#cb645-10"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb645-11"><a href="kriging.html#cb645-11"></a><span class="st">  </span><span class="kw">geom_line</span>(tab, <span class="dt">mapping =</span> <span class="kw">aes</span>(h, gamma), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&#39;steelblue&#39;</span>) <span class="op">+</span></span>
<span id="cb645-12"><a href="kriging.html#cb645-12"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> a, <span class="dt">color =</span> <span class="st">&#39;orangered&#39;</span>) <span class="op">+</span></span>
<span id="cb645-13"><a href="kriging.html#cb645-13"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> a <span class="op">+</span><span class="st"> </span><span class="dv">3</span>, <span class="dt">y =</span> <span class="fl">0.5625</span>, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;a =&quot;</span>, a), <span class="dt">color =</span> <span class="st">&#39;orangered&#39;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb645-14"><a href="kriging.html#cb645-14"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-606-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>Данная модель достигает плато в точке <span class="math inline">\(h = a\)</span>.</p>
</div>
<div id="экспоненциальная-модель" class="section level3">
<h3><span class="header-section-number">14.4.13</span> Экспоненциальная модель</h3>
<p><span class="math display">\[\gamma(h) = \begin{cases}
  0, &amp; h = 0; \\
  c_0 + (c-c_0)\Big[1 - \exp\big(\frac{-3h}{a}\big)\Big], &amp; h \neq 0.
\end{cases}\]</span></p>
<p><span class="math display">\[\gamma(a) = \Var\big[Z(p)\big] = c_0 + c\]</span></p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="kriging.html#cb646-1"></a>tab =<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tibble</span>(</span>
<span id="cb646-2"><a href="kriging.html#cb646-2"></a>  <span class="dt">h =</span> h,</span>
<span id="cb646-3"><a href="kriging.html#cb646-3"></a>  <span class="dt">gamma =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">3</span><span class="op">*</span>h<span class="op">/</span>a)</span>
<span id="cb646-4"><a href="kriging.html#cb646-4"></a>)</span>
<span id="cb646-5"><a href="kriging.html#cb646-5"></a></span>
<span id="cb646-6"><a href="kriging.html#cb646-6"></a>pl =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb646-7"><a href="kriging.html#cb646-7"></a><span class="st">  </span><span class="kw">geom_line</span>(tab, <span class="dt">mapping =</span> <span class="kw">aes</span>(h, gamma), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&#39;steelblue&#39;</span>) <span class="op">+</span></span>
<span id="cb646-8"><a href="kriging.html#cb646-8"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> a, <span class="dt">color =</span> <span class="st">&#39;orangered&#39;</span>) <span class="op">+</span></span>
<span id="cb646-9"><a href="kriging.html#cb646-9"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> a <span class="op">+</span><span class="st"> </span><span class="dv">3</span>, <span class="dt">y =</span> <span class="fl">0.5625</span>, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;a =&quot;</span>, a), <span class="dt">color =</span> <span class="st">&#39;orangered&#39;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb646-10"><a href="kriging.html#cb646-10"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span>
<span id="cb646-11"><a href="kriging.html#cb646-11"></a></span>
<span id="cb646-12"><a href="kriging.html#cb646-12"></a>(pl)</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-607-1.png" width="2100" style="display: block; margin: auto;" /></p>
<ul>
<li>Данная модель достигает плато асимптотически.</li>
<li>В точке <span class="math inline">\(h = a\)</span> достигается <span class="math inline">\(95\%\)</span> уровня плато.</li>
</ul>
</div>
<div id="гауссова-модель" class="section level3">
<h3><span class="header-section-number">14.4.14</span> Гауссова модель</h3>
<p><span class="math display">\[\gamma(h) = c_0 + c\Bigg[1 - \exp\bigg(\frac{-3h^2}{a^2}\bigg)\Bigg]\]</span></p>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="kriging.html#cb647-1"></a>tab =<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tibble</span>(</span>
<span id="cb647-2"><a href="kriging.html#cb647-2"></a>  <span class="dt">h =</span> h,</span>
<span id="cb647-3"><a href="kriging.html#cb647-3"></a>  <span class="dt">gamma =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">3</span><span class="op">*</span>h<span class="op">^</span><span class="dv">2</span><span class="op">/</span>a<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb647-4"><a href="kriging.html#cb647-4"></a>)</span>
<span id="cb647-5"><a href="kriging.html#cb647-5"></a></span>
<span id="cb647-6"><a href="kriging.html#cb647-6"></a>pl =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb647-7"><a href="kriging.html#cb647-7"></a><span class="st">  </span><span class="kw">geom_line</span>(tab, <span class="dt">mapping =</span> <span class="kw">aes</span>(h, gamma), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&#39;steelblue&#39;</span>) <span class="op">+</span></span>
<span id="cb647-8"><a href="kriging.html#cb647-8"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> a, <span class="dt">color =</span> <span class="st">&#39;orangered&#39;</span>) <span class="op">+</span></span>
<span id="cb647-9"><a href="kriging.html#cb647-9"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> a <span class="op">+</span><span class="st"> </span><span class="dv">3</span>, <span class="dt">y =</span> <span class="fl">0.5625</span>, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;a =&quot;</span>, a), <span class="dt">color =</span> <span class="st">&#39;orangered&#39;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb647-10"><a href="kriging.html#cb647-10"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span>
<span id="cb647-11"><a href="kriging.html#cb647-11"></a></span>
<span id="cb647-12"><a href="kriging.html#cb647-12"></a>(pl)</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-608-1.png" width="2100" style="display: block; margin: auto;" /></p>
<ul>
<li>Данная модель достигает плато асимптотически.</li>
<li>В точке <span class="math inline">\(h = a\)</span> достигается <span class="math inline">\(95\%\)</span> уровня плато.</li>
<li>Отличительной чертой этой модели является ее гладкость: параболическое поведение вблизи нуля и асимптотическое приближение к плато.</li>
</ul>
</div>
<div id="степенная-модель" class="section level3">
<h3><span class="header-section-number">14.4.15</span> Степенная модель</h3>
<p><span class="math display">\[\gamma(h) = \begin{cases}
  0, &amp; h = 0; \\
  c h^\alpha, &amp; h \neq 0.
\end{cases}\]</span></p>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="kriging.html#cb648-1"></a>tab =<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tibble</span>(</span>
<span id="cb648-2"><a href="kriging.html#cb648-2"></a>  <span class="dt">h =</span> h,</span>
<span id="cb648-3"><a href="kriging.html#cb648-3"></a>  <span class="dt">gamma =</span> h<span class="op">^</span><span class="fl">1.5</span></span>
<span id="cb648-4"><a href="kriging.html#cb648-4"></a>)</span>
<span id="cb648-5"><a href="kriging.html#cb648-5"></a></span>
<span id="cb648-6"><a href="kriging.html#cb648-6"></a>pl =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb648-7"><a href="kriging.html#cb648-7"></a><span class="st">  </span><span class="kw">geom_line</span>(tab, <span class="dt">mapping =</span> <span class="kw">aes</span>(h, gamma), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&#39;steelblue&#39;</span>) <span class="op">+</span></span>
<span id="cb648-8"><a href="kriging.html#cb648-8"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span>
<span id="cb648-9"><a href="kriging.html#cb648-9"></a></span>
<span id="cb648-10"><a href="kriging.html#cb648-10"></a>(pl)</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-609-1.png" width="2100" style="display: block; margin: auto;" /></p>
<ul>
<li>Автокорреляция присутствует на всех расстояниях: <span class="math inline">\(a \rightarrow \infty\)</span></li>
<li>Предположение о стационарности второго порядка не выполняется</li>
<li>Как правило, это означает наличие тренда в данных</li>
</ul>
</div>
<div id="эффект-самородка-модель-наггет" class="section level3">
<h3><span class="header-section-number">14.4.16</span> Эффект самородка (модель наггет)</h3>
<p><span class="math display">\[\gamma(h) = \begin{cases}
  0, &amp; h = 0; \\
  c_0, &amp; h \neq 0.
\end{cases}, ~ c_0 = C(0)\]</span></p>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="kriging.html#cb649-1"></a>tab =<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tibble</span>(</span>
<span id="cb649-2"><a href="kriging.html#cb649-2"></a>  <span class="dt">gamma =</span> <span class="kw">rep</span>(<span class="dv">1</span>, n<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb649-3"><a href="kriging.html#cb649-3"></a>  <span class="dt">h =</span> h</span>
<span id="cb649-4"><a href="kriging.html#cb649-4"></a>)</span>
<span id="cb649-5"><a href="kriging.html#cb649-5"></a></span>
<span id="cb649-6"><a href="kriging.html#cb649-6"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb649-7"><a href="kriging.html#cb649-7"></a><span class="st">  </span><span class="kw">geom_line</span>(tab, <span class="dt">mapping =</span> <span class="kw">aes</span>(h, gamma), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&#39;steelblue&#39;</span>) <span class="op">+</span></span>
<span id="cb649-8"><a href="kriging.html#cb649-8"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">1</span>), <span class="dt">mapping =</span> <span class="kw">aes</span>(x, y), <span class="dt">shape=</span><span class="dv">21</span>,</span>
<span id="cb649-9"><a href="kriging.html#cb649-9"></a>             <span class="dt">colour =</span> <span class="st">&#39;steelblue&#39;</span>, <span class="dt">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">stroke =</span> <span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb649-10"><a href="kriging.html#cb649-10"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&#39;point&#39;</span>, <span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&#39;steelblue&#39;</span>, <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span></span>
<span id="cb649-11"><a href="kriging.html#cb649-11"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/sam-1.png" width="2100" style="display: block; margin: auto;" /></p>
<ul>
<li>Наличие у данных вариограммы типа наггет означает отсутствие пространственной корреляции.</li>
<li>Возможные причины:
<ul>
<li>Абсолютно случайное распределение</li>
<li>Мелкомасштабная вариабельность (меньше, чем расстояние между измерениями)</li>
<li>Ошибки в измерениях</li>
<li>Ошибки в координатах точек</li>
</ul></li>
</ul>
</div>
<div id="диаграмма-рассеяния-с-лагом" class="section level3">
<h3><span class="header-section-number">14.4.17</span> Диаграмма рассеяния с лагом</h3>
<p><strong>Lagged scatterplot</strong> — вариант диаграммы рассеяния, на котором показываются значения в точках, расстояние между которыми попадает в заданный интервал</p>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="kriging.html#cb650-1"></a><span class="kw">options</span>(<span class="dt">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb650-2"><a href="kriging.html#cb650-2"></a></span>
<span id="cb650-3"><a href="kriging.html#cb650-3"></a>cities =<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/Italy_Cities.gpkg&quot;</span>)</span>
<span id="cb650-4"><a href="kriging.html#cb650-4"></a><span class="co">## Reading layer `Italy_Cities&#39; from data source `/Users/tsamsonov/GitHub/r-geo-course/data/Italy_Cities.gpkg&#39; using driver `GPKG&#39;</span></span>
<span id="cb650-5"><a href="kriging.html#cb650-5"></a><span class="co">## Simple feature collection with 8 features and 37 fields</span></span>
<span id="cb650-6"><a href="kriging.html#cb650-6"></a><span class="co">## geometry type:  POINT</span></span>
<span id="cb650-7"><a href="kriging.html#cb650-7"></a><span class="co">## dimension:      XY</span></span>
<span id="cb650-8"><a href="kriging.html#cb650-8"></a><span class="co">## bbox:           xmin: 368910.4 ymin: 4930119 xmax: 686026 ymax: 5115936</span></span>
<span id="cb650-9"><a href="kriging.html#cb650-9"></a><span class="co">## projected CRS:  WGS 84 / UTM zone 32N</span></span>
<span id="cb650-10"><a href="kriging.html#cb650-10"></a></span>
<span id="cb650-11"><a href="kriging.html#cb650-11"></a>rainfall =<span class="st"> </span><span class="kw">read_table2</span>(<span class="st">&quot;data/Rainfall.dat&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb650-12"><a href="kriging.html#cb650-12"></a><span class="st">  </span><span class="kw">st_as_sf</span>(<span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&#39;x&#39;</span>, <span class="st">&#39;y&#39;</span>), </span>
<span id="cb650-13"><a href="kriging.html#cb650-13"></a>           <span class="dt">crs =</span> <span class="kw">st_crs</span>(cities),</span>
<span id="cb650-14"><a href="kriging.html#cb650-14"></a>           <span class="dt">remove =</span> <span class="ot">FALSE</span>)</span>
<span id="cb650-15"><a href="kriging.html#cb650-15"></a></span>
<span id="cb650-16"><a href="kriging.html#cb650-16"></a><span class="kw">hscat</span>(rain_<span class="dv">24</span><span class="op">~</span><span class="dv">1</span>, <span class="dt">data =</span> rainfall, <span class="dv">1000</span> <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">100</span>), <span class="dt">pch =</span> <span class="dv">19</span>)</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-610-1.png" width="2100" style="display: block; margin: auto;" /></p>
</div>
<div id="вариограммное-облако" class="section level3">
<h3><span class="header-section-number">14.4.18</span> Вариограммное облако</h3>
<p>Квадрат разности значений как функция от расстояния между точками</p>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="kriging.html#cb651-1"></a>varcl =<span class="st"> </span><span class="kw">variogram</span>(rain_<span class="dv">24</span><span class="op">~</span><span class="dv">1</span>, <span class="dt">data=</span>rainfall, <span class="dt">cutoff =</span> <span class="dv">150000</span>, <span class="dt">cloud=</span><span class="ot">TRUE</span>)</span>
<span id="cb651-2"><a href="kriging.html#cb651-2"></a></span>
<span id="cb651-3"><a href="kriging.html#cb651-3"></a><span class="kw">ggplot</span>(varcl) <span class="op">+</span></span>
<span id="cb651-4"><a href="kriging.html#cb651-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(dist, gamma), <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&#39;steelblue&#39;</span>) <span class="op">+</span></span>
<span id="cb651-5"><a href="kriging.html#cb651-5"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&#39;semivariance&#39;</span>) <span class="op">+</span></span>
<span id="cb651-6"><a href="kriging.html#cb651-6"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-611-1.png" width="2100" /></p>
</div>
<div id="эмпирическая-вариограмма" class="section level3">
<h3><span class="header-section-number">14.4.19</span> Эмпирическая вариограмма</h3>
<p>Эмпирическая вариограмма рассчитывается путем разбения вариограммного облака на интервалы расстояний — <strong>лаги</strong> — и подсчета среднего значения <span class="math inline">\(\gamma\)</span> в каждом лаге по следующей формуле:</p>
<p><span class="math display">\[\hat{\gamma} = \frac{1}{2N_h} \sum_{x_i - x_j \approx h} \big[z(x_i) - z(x_j)\big]^2\]</span></p>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="kriging.html#cb652-1"></a>width =<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb652-2"><a href="kriging.html#cb652-2"></a>intervals =<span class="st"> </span>width <span class="op">*</span><span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">15</span></span>
<span id="cb652-3"><a href="kriging.html#cb652-3"></a></span>
<span id="cb652-4"><a href="kriging.html#cb652-4"></a>vargr =<span class="st"> </span><span class="kw">variogram</span>(rain_<span class="dv">24</span><span class="op">~</span><span class="dv">1</span>, <span class="dt">data=</span>rainfall, <span class="dt">cutoff =</span> <span class="dv">150000</span>, <span class="dt">width =</span> width)</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-613-1.png" width="672" /></p>
<p>Оставив только вариограмму, получим:</p>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="kriging.html#cb653-1"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb653-2"><a href="kriging.html#cb653-2"></a><span class="st">  </span><span class="kw">geom_line</span>(vargr, <span class="dt">mapping =</span> <span class="kw">aes</span>(dist, gamma)) <span class="op">+</span></span>
<span id="cb653-3"><a href="kriging.html#cb653-3"></a><span class="st">  </span><span class="kw">geom_point</span>(vargr, <span class="dt">mapping =</span> <span class="kw">aes</span>(dist, gamma, <span class="dt">size =</span> np)) <span class="op">+</span></span>
<span id="cb653-4"><a href="kriging.html#cb653-4"></a><span class="st">  </span><span class="kw">scale_size</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)) <span class="op">+</span></span>
<span id="cb653-5"><a href="kriging.html#cb653-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-614-1.png" width="2100" />
Размер точки означает количество пар значений, которые попали в каждый лаг.</p>
<p>Поскольку вариограмма есть <em>дисперсия разности значений</em>, ее рост при увеличении расстояния можно оценить также по увеличению размера «ящика» на диаграмме размаха <span class="math inline">\(\sqrt\gamma\)</span>:</p>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="kriging.html#cb654-1"></a>varcl =<span class="st"> </span>varcl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb654-2"><a href="kriging.html#cb654-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sqgamma =</span> <span class="kw">sqrt</span>(gamma),</span>
<span id="cb654-3"><a href="kriging.html#cb654-3"></a>         <span class="dt">lag =</span> <span class="kw">cut</span>(dist, <span class="dt">breaks =</span> intervals, <span class="dt">labels =</span> <span class="fl">0.001</span> <span class="op">*</span><span class="st"> </span>(intervals[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>width)))</span>
<span id="cb654-4"><a href="kriging.html#cb654-4"></a></span>
<span id="cb654-5"><a href="kriging.html#cb654-5"></a><span class="kw">ggplot</span>(varcl) <span class="op">+</span></span>
<span id="cb654-6"><a href="kriging.html#cb654-6"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(lag, <span class="kw">sqrt</span>(gamma)), <span class="dt">outlier.alpha =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-615-1.png" width="2100" /></p>
</div>
<div id="вариокарта" class="section level3">
<h3><span class="header-section-number">14.4.20</span> Вариокарта</h3>
<p><strong>Вариокарта</strong> (<em>variogram map, variomap</em>) представляет вариограмму как функцию приращений координат:
<span class="math display">\[\hat{\gamma} (\Delta x, \Delta y) = \frac{1}{2N_{\substack{\Delta x\\ \Delta y}}} \sum_{\substack{\Delta x_{ij} \approx \Delta x\\ \Delta y_{ij} \approx \Delta y}} \big[z(p_i) - z(p_j)\big]^2\]</span></p>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="kriging.html#cb655-1"></a>varmp =<span class="st"> </span><span class="kw">variogram</span>(rain_<span class="dv">24</span><span class="op">~</span><span class="dv">1</span>, <span class="dt">data=</span>rainfall, <span class="dt">cutoff =</span> <span class="dv">150000</span>, <span class="dt">width =</span> width, <span class="dt">map =</span> <span class="ot">TRUE</span>)[[<span class="st">&#39;map&#39;</span>]]</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-617-1.png" width="672" /></p>
<p>Вариокарта используется для выявления <em>пространственной анизотропии</em>. Профиль по линии из центра к краю вариокарты даст эмпирическую вариограмму</p>
</div>
<div id="приближение-теоретической-модели" class="section level3">
<h3><span class="header-section-number">14.4.21</span> Приближение теоретической модели</h3>
<p><strong>Приближение</strong> (<em>fitting</em>) модели вариограммы предполагает:</p>
<ol style="list-style-type: decimal">
<li>Выбор теоретической модели</li>
<li>Подбор параметров модели: эффект самородка (nugget), радиус корреляции и плато.</li>
</ol>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-618-1.png" width="2100" /></p>
<p>Дана вариограмма семейства <span class="math inline">\(\gamma (h; \mathbf{b})\)</span>, где <span class="math inline">\(\mathbf{b} = (b_1, ..., b_k)\)</span> — вектор из <span class="math inline">\(k\)</span> параметров модели. Параметры <span class="math inline">\(\mathbf{b}\)</span> подбираются таким образом, чтобы минимизировать следующий функционал:</p>
<p><span class="math display">\[Q(\mathbf{b}) = \sum_{l=1}^{L} w_l \big[\hat{\gamma}(h_l) - \gamma (h; \mathbf{b})\big]^2,\]</span></p>
<p>где <span class="math inline">\(\big\{\hat{\gamma} (h_l): l = 1,...,L\big\}\)</span> — значения эмпирической вариограммы для <span class="math inline">\(L\)</span> лагов, вычисленные по <span class="math inline">\(N(h_l)\)</span> векторам.</p>
<p>Веса <span class="math inline">\(w_l\)</span> обычно выбираются исходя из отношения <span class="math inline">\(w_l = N(h_l) / |h_l|\)</span>, чтобы придать большее значение коротким расстояниям и лагам с хорошей оценкой.</p>
<p>Минимизация функционала осуществляется итеративно:</p>
<ol style="list-style-type: decimal">
<li>Процесс начинается с некоторого предположения <span class="math inline">\(\mathbf{b}^{(0)}\)</span></li>
<li>На шаге <span class="math inline">\(s\)</span> функция <span class="math inline">\(Q\)</span> аппроксимируется в виде квадратичной формы <span class="math inline">\(Q(\mathbf{b}^{(s)}) \approx \sum_{i=1}^k \sum_{j=1}^k \delta_{ij} b_i b_j\)</span> путем разложения в ряд Тейлора вокруг точки <span class="math inline">\(\mathbf{b}^{(s)}\)</span>.</li>
<li>Новая точка минимума <span class="math inline">\(\mathbf{b}^{(s+1)}\)</span> находится как минимум квадратичной формы (<em>этот минимум один</em>).</li>
</ol>
<p>Шаги 2-3 повторяются до тех пор, пока значение <span class="math inline">\(Q\)</span> не станет меньше заданного порога.</p>
<p>Сравним результат ручного и автоматического приближения вариограммы:</p>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="kriging.html#cb656-1"></a>varmd =<span class="st"> </span><span class="kw">fit.variogram</span>(vargr, <span class="dt">model =</span> <span class="kw">vgm</span>(<span class="dt">psill =</span> <span class="dv">215</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">120000</span>, <span class="dt">nugget =</span> <span class="dv">15</span>))</span>
<span id="cb656-2"><a href="kriging.html#cb656-2"></a></span>
<span id="cb656-3"><a href="kriging.html#cb656-3"></a>h0 =<span class="st"> </span>lag <span class="op">*</span><span class="st"> </span><span class="dv">0</span><span class="op">:</span>(varmd[<span class="dv">2</span>, <span class="st">&#39;range&#39;</span>]<span class="op">/</span>lag)</span>
<span id="cb656-4"><a href="kriging.html#cb656-4"></a>h1 =<span class="st"> </span>lag <span class="op">*</span><span class="st"> </span>(varmd[<span class="dv">2</span>, <span class="st">&#39;range&#39;</span>]<span class="op">/</span>lag <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(cutoff<span class="op">/</span>lag) </span>
<span id="cb656-5"><a href="kriging.html#cb656-5"></a></span>
<span id="cb656-6"><a href="kriging.html#cb656-6"></a>tab2 =<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tibble</span>(</span>
<span id="cb656-7"><a href="kriging.html#cb656-7"></a>  <span class="dt">h =</span> <span class="kw">c</span>(h0, h1),</span>
<span id="cb656-8"><a href="kriging.html#cb656-8"></a>  <span class="dt">gamma =</span> <span class="kw">c</span>(varmd[<span class="dv">1</span>, <span class="st">&#39;psill&#39;</span>] <span class="op">+</span><span class="st"> </span>(varmd[<span class="dv">2</span>, <span class="st">&#39;psill&#39;</span>] <span class="op">*</span><span class="st"> </span>(<span class="dv">3</span> <span class="op">*</span><span class="st"> </span>h0 <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>varmd[<span class="dv">2</span>, <span class="st">&#39;range&#39;</span>]) <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>(h0 <span class="op">/</span><span class="st"> </span>varmd[<span class="dv">2</span>, <span class="st">&#39;range&#39;</span>])<span class="op">^</span><span class="dv">3</span>)), <span class="kw">rep</span>(varmd[<span class="dv">1</span>, <span class="st">&#39;psill&#39;</span>] <span class="op">+</span><span class="st"> </span>varmd[<span class="dv">2</span>, <span class="st">&#39;psill&#39;</span>], <span class="kw">length</span>(h1))),</span>
<span id="cb656-9"><a href="kriging.html#cb656-9"></a>  <span class="dt">fit =</span> <span class="st">&#39;automatic&#39;</span></span>
<span id="cb656-10"><a href="kriging.html#cb656-10"></a>)</span>
<span id="cb656-11"><a href="kriging.html#cb656-11"></a></span>
<span id="cb656-12"><a href="kriging.html#cb656-12"></a>tab =<span class="st"> </span><span class="kw">bind_rows</span>(tab1, tab2)</span>
<span id="cb656-13"><a href="kriging.html#cb656-13"></a></span>
<span id="cb656-14"><a href="kriging.html#cb656-14"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb656-15"><a href="kriging.html#cb656-15"></a><span class="st">  </span><span class="kw">geom_line</span>(vargr, <span class="dt">mapping =</span> <span class="kw">aes</span>(dist, gamma)) <span class="op">+</span></span>
<span id="cb656-16"><a href="kriging.html#cb656-16"></a><span class="st">  </span><span class="kw">geom_point</span>(vargr, <span class="dt">mapping =</span> <span class="kw">aes</span>(dist, gamma), <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb656-17"><a href="kriging.html#cb656-17"></a><span class="st">  </span><span class="kw">scale_size</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)) <span class="op">+</span></span>
<span id="cb656-18"><a href="kriging.html#cb656-18"></a><span class="st">  </span><span class="kw">geom_line</span>(tab, <span class="dt">mapping =</span> <span class="kw">aes</span>(h, gamma, <span class="dt">color =</span> fit), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb656-19"><a href="kriging.html#cb656-19"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&#39;lag&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&#39;gamma&#39;</span>) <span class="op">+</span></span>
<span id="cb656-20"><a href="kriging.html#cb656-20"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&#39;Сферическая модель&#39;</span>) <span class="op">+</span></span>
<span id="cb656-21"><a href="kriging.html#cb656-21"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-619-1.png" width="2100" /></p>
</div>
<div id="обычный-кригинг-1" class="section level3">
<h3><span class="header-section-number">14.4.22</span> Обычный кригинг</h3>
<p>Рассмотрим данные по температуре:</p>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="kriging.html#cb657-1"></a>box =<span class="st"> </span><span class="kw">st_bbox</span>(rainfall)</span>
<span id="cb657-2"><a href="kriging.html#cb657-2"></a>envelope =<span class="st"> </span>box[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>)]</span>
<span id="cb657-3"><a href="kriging.html#cb657-3"></a></span>
<span id="cb657-4"><a href="kriging.html#cb657-4"></a>px_grid =<span class="st"> </span><span class="kw">st_as_stars</span>(box, <span class="dt">dx =</span> <span class="dv">2000</span>, <span class="dt">dy =</span> <span class="dv">2000</span>)</span>
<span id="cb657-5"><a href="kriging.html#cb657-5"></a></span>
<span id="cb657-6"><a href="kriging.html#cb657-6"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb657-7"><a href="kriging.html#cb657-7"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> rainfall, <span class="dt">color =</span> <span class="st">&#39;red&#39;</span>) <span class="op">+</span></span>
<span id="cb657-8"><a href="kriging.html#cb657-8"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> <span class="kw">st_as_sf</span>(px_grid), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">fill =</span> <span class="ot">NA</span>)</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-620-1.png" width="2100" /></p>
</div>
<div id="обычный-кригинг-2" class="section level3">
<h3><span class="header-section-number">14.4.23</span> Обычный кригинг</h3>
<p>Визуализируем найденную вариограмму и вариокарту:</p>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="kriging.html#cb658-1"></a><span class="kw">plot</span>(vargr, <span class="dt">model =</span> varmd)</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-621-1.png" width="672" /></p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="kriging.html#cb659-1"></a><span class="kw">plot</span>(varmp)</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-621-2.png" width="672" /></p>
<p>Проинтерполируем, используя приближенную модель вариограммы:</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="kriging.html#cb660-1"></a>(<span class="dt">px_grid =</span> <span class="kw">krige</span>(rain_<span class="dv">24</span><span class="op">~</span><span class="dv">1</span>, rainfall, px_grid, <span class="dt">model =</span> varmd))</span>
<span id="cb660-2"><a href="kriging.html#cb660-2"></a><span class="co">## [using ordinary kriging]</span></span>
<span id="cb660-3"><a href="kriging.html#cb660-3"></a><span class="co">## stars object with 2 dimensions and 2 attributes</span></span>
<span id="cb660-4"><a href="kriging.html#cb660-4"></a><span class="co">## attribute(s):</span></span>
<span id="cb660-5"><a href="kriging.html#cb660-5"></a><span class="co">##    var1.pred         var1.var      </span></span>
<span id="cb660-6"><a href="kriging.html#cb660-6"></a><span class="co">##  Min.   :-0.4092   Min.   : 30.99  </span></span>
<span id="cb660-7"><a href="kriging.html#cb660-7"></a><span class="co">##  1st Qu.: 7.7076   1st Qu.: 45.44  </span></span>
<span id="cb660-8"><a href="kriging.html#cb660-8"></a><span class="co">##  Median :18.8332   Median : 52.72  </span></span>
<span id="cb660-9"><a href="kriging.html#cb660-9"></a><span class="co">##  Mean   :21.5098   Mean   : 58.67  </span></span>
<span id="cb660-10"><a href="kriging.html#cb660-10"></a><span class="co">##  3rd Qu.:32.0739   3rd Qu.: 65.48  </span></span>
<span id="cb660-11"><a href="kriging.html#cb660-11"></a><span class="co">##  Max.   :67.2664   Max.   :186.22  </span></span>
<span id="cb660-12"><a href="kriging.html#cb660-12"></a><span class="co">## dimension(s):</span></span>
<span id="cb660-13"><a href="kriging.html#cb660-13"></a><span class="co">##   from  to  offset delta                refsys point values    </span></span>
<span id="cb660-14"><a href="kriging.html#cb660-14"></a><span class="co">## x    1 213  332239  2000 WGS 84 / UTM zone 32N    NA   NULL [x]</span></span>
<span id="cb660-15"><a href="kriging.html#cb660-15"></a><span class="co">## y    1  99 5121556 -2000 WGS 84 / UTM zone 32N    NA   NULL [y]</span></span></code></pre></div>
</div>
<div id="оценка-и-дисперсия-кригинга" class="section level3">
<h3><span class="header-section-number">14.4.24</span> Оценка и дисперсия кригинга</h3>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="kriging.html#cb661-1"></a>rain_colors =<span class="st"> </span><span class="kw">colorRampPalette</span>(<span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>))</span>
<span id="cb661-2"><a href="kriging.html#cb661-2"></a>rain_levels =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">80</span>,<span class="dt">by=</span><span class="dv">10</span>)</span>
<span id="cb661-3"><a href="kriging.html#cb661-3"></a>rain_ncolors =<span class="st"> </span><span class="kw">length</span>(rain_levels)<span class="op">-</span><span class="dv">1</span></span>
<span id="cb661-4"><a href="kriging.html#cb661-4"></a></span>
<span id="cb661-5"><a href="kriging.html#cb661-5"></a>err_colors =<span class="st"> </span><span class="kw">colorRampPalette</span>(<span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;coral&quot;</span>, <span class="st">&quot;violetred&quot;</span>))</span>
<span id="cb661-6"><a href="kriging.html#cb661-6"></a>err_levels =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">180</span>, <span class="dt">by =</span> <span class="dv">20</span>)</span>
<span id="cb661-7"><a href="kriging.html#cb661-7"></a>err_ncolors =<span class="st"> </span><span class="kw">length</span>(err_levels) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb661-8"><a href="kriging.html#cb661-8"></a></span>
<span id="cb661-9"><a href="kriging.html#cb661-9"></a>cont =<span class="st"> </span><span class="kw">st_contour</span>(px_grid[<span class="st">&#39;var1.pred&#39;</span>], <span class="dt">breaks =</span> rain_levels, <span class="dt">contour_lines =</span> <span class="ot">TRUE</span>)</span>
<span id="cb661-10"><a href="kriging.html#cb661-10"></a>conterr =<span class="st"> </span><span class="kw">st_contour</span>(px_grid[<span class="st">&#39;var1.var&#39;</span>], <span class="dt">breaks =</span> err_levels, <span class="dt">contour_lines =</span> <span class="ot">TRUE</span>)</span>
<span id="cb661-11"><a href="kriging.html#cb661-11"></a></span>
<span id="cb661-12"><a href="kriging.html#cb661-12"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb661-13"><a href="kriging.html#cb661-13"></a><span class="st">  </span><span class="kw">geom_stars</span>(<span class="dt">data =</span> <span class="kw">cut</span>(px_grid[<span class="st">&#39;var1.pred&#39;</span>], <span class="dt">breaks =</span> rain_levels)) <span class="op">+</span></span>
<span id="cb661-14"><a href="kriging.html#cb661-14"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">name =</span> <span class="st">&#39;мм&#39;</span>,</span>
<span id="cb661-15"><a href="kriging.html#cb661-15"></a>                    <span class="dt">values =</span> <span class="kw">rain_colors</span>(rain_ncolors),</span>
<span id="cb661-16"><a href="kriging.html#cb661-16"></a>                    <span class="dt">labels =</span> <span class="kw">paste</span>(rain_levels[<span class="op">-</span>rain_ncolors<span class="dv">-1</span>], <span class="st">&#39;-&#39;</span>, rain_levels[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb661-17"><a href="kriging.html#cb661-17"></a>                    <span class="dt">drop =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb661-18"><a href="kriging.html#cb661-18"></a><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">crs =</span> <span class="kw">st_crs</span>(rainfall)) <span class="op">+</span></span>
<span id="cb661-19"><a href="kriging.html#cb661-19"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> cont, <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size =</span> <span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb661-20"><a href="kriging.html#cb661-20"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> rainfall, <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb661-21"><a href="kriging.html#cb661-21"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-623-1.png" width="2100" /></p>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="kriging.html#cb662-1"></a></span>
<span id="cb662-2"><a href="kriging.html#cb662-2"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb662-3"><a href="kriging.html#cb662-3"></a><span class="st">  </span><span class="kw">geom_stars</span>(<span class="dt">data =</span> <span class="kw">cut</span>(px_grid[<span class="st">&#39;var1.var&#39;</span>], <span class="dt">breaks =</span> err_levels)) <span class="op">+</span></span>
<span id="cb662-4"><a href="kriging.html#cb662-4"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">name =</span> <span class="st">&#39;мм&#39;</span>,</span>
<span id="cb662-5"><a href="kriging.html#cb662-5"></a>                    <span class="dt">values =</span> <span class="kw">err_colors</span>(err_ncolors),</span>
<span id="cb662-6"><a href="kriging.html#cb662-6"></a>                    <span class="dt">labels =</span> <span class="kw">paste</span>(err_levels[<span class="op">-</span>err_ncolors<span class="dv">-1</span>], <span class="st">&#39;-&#39;</span>, err_levels[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb662-7"><a href="kriging.html#cb662-7"></a>                    <span class="dt">drop =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb662-8"><a href="kriging.html#cb662-8"></a><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">crs =</span> <span class="kw">st_crs</span>(rainfall)) <span class="op">+</span></span>
<span id="cb662-9"><a href="kriging.html#cb662-9"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> conterr, <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size =</span> <span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb662-10"><a href="kriging.html#cb662-10"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> rainfall, <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb662-11"><a href="kriging.html#cb662-11"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-623-2.png" width="2100" /></p>
<p>Дисперсия кригинга высока там, где мало данных.</p>
</div>
<div id="кросс-валидация-1" class="section level3">
<h3><span class="header-section-number">14.4.25</span> Кросс-валидация</h3>
<p>Для выполнения кросс-валидации воспользуемся функцией <code>krige.cv</code>:</p>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="kriging.html#cb663-1"></a>cvl =<span class="st"> </span><span class="kw">krige.cv</span>(rain_<span class="dv">24</span><span class="op">~</span><span class="dv">1</span>, rainfall, varmd) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb663-2"><a href="kriging.html#cb663-2"></a><span class="st">  </span><span class="kw">st_as_sf</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb663-3"><a href="kriging.html#cb663-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sterr =</span> residual <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(var1.var))</span>
<span id="cb663-4"><a href="kriging.html#cb663-4"></a></span>
<span id="cb663-5"><a href="kriging.html#cb663-5"></a><span class="kw">head</span>(cvl <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_set_geometry</span>(<span class="ot">NULL</span>), <span class="dv">10</span>)</span>
<span id="cb663-6"><a href="kriging.html#cb663-6"></a><span class="co">##    var1.pred var1.var observed     residual      zscore fold       sterr</span></span>
<span id="cb663-7"><a href="kriging.html#cb663-7"></a><span class="co">## 1   5.743730 34.84033      6.0   0.25627005  0.04341669    1  0.04341669</span></span>
<span id="cb663-8"><a href="kriging.html#cb663-8"></a><span class="co">## 2  11.137129 60.24070     10.0  -1.13712865 -0.14650910    2 -0.14650910</span></span>
<span id="cb663-9"><a href="kriging.html#cb663-9"></a><span class="co">## 3   6.929502 47.22732      7.0   0.07049833  0.01025846    3  0.01025846</span></span>
<span id="cb663-10"><a href="kriging.html#cb663-10"></a><span class="co">## 4  23.252858 48.06354      1.0 -22.25285758 -3.20979954    4 -3.20979954</span></span>
<span id="cb663-11"><a href="kriging.html#cb663-11"></a><span class="co">## 5  15.655167 56.76258      1.0 -14.65516724 -1.94517957    5 -1.94517957</span></span>
<span id="cb663-12"><a href="kriging.html#cb663-12"></a><span class="co">## 6  11.794241 44.03055      1.0 -10.79424095 -1.62672846    6 -1.62672846</span></span>
<span id="cb663-13"><a href="kriging.html#cb663-13"></a><span class="co">## 7  11.325378 62.65261      0.1 -11.22537769 -1.41818009    7 -1.41818009</span></span>
<span id="cb663-14"><a href="kriging.html#cb663-14"></a><span class="co">## 8  28.421330 75.24988      0.2 -28.22133030 -3.25330355    8 -3.25330355</span></span>
<span id="cb663-15"><a href="kriging.html#cb663-15"></a><span class="co">## 9   2.340115 58.30350      1.0  -1.34011550 -0.17550719    9 -0.17550719</span></span>
<span id="cb663-16"><a href="kriging.html#cb663-16"></a><span class="co">## 10  3.489972 62.96551      0.2  -3.28997242 -0.41461106   10 -0.41461106</span></span></code></pre></div>
<p>Cтандартизированные ошибки в стационарном случае должны быть распределены нормально:</p>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="kriging.html#cb664-1"></a><span class="kw">ggplot</span>(cvl, <span class="kw">aes</span>(<span class="dt">x =</span> sterr)) <span class="op">+</span></span>
<span id="cb664-2"><a href="kriging.html#cb664-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">stat</span>(density)), <span class="dt">fill =</span> <span class="st">&#39;grey&#39;</span>, <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size =</span> <span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb664-3"><a href="kriging.html#cb664-3"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">fill =</span> <span class="st">&#39;olivedrab&#39;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb664-4"><a href="kriging.html#cb664-4"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-625-1.png" width="2100" /></p>
<p>Ошибки должны быть независимы от значений:</p>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="kriging.html#cb665-1"></a><span class="kw">ggplot</span>(cvl, <span class="kw">aes</span>(<span class="dt">x =</span> var1.pred, sterr)) <span class="op">+</span></span>
<span id="cb665-2"><a href="kriging.html#cb665-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span></span>
<span id="cb665-3"><a href="kriging.html#cb665-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>) <span class="op">+</span></span>
<span id="cb665-4"><a href="kriging.html#cb665-4"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-626-1.png" width="2100" /></p>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="kriging.html#cb666-1"></a></span>
<span id="cb666-2"><a href="kriging.html#cb666-2"></a><span class="kw">cor.test</span>(<span class="op">~</span><span class="st"> </span>sterr <span class="op">+</span><span class="st"> </span>var1.pred, <span class="dt">data =</span> cvl)</span>
<span id="cb666-3"><a href="kriging.html#cb666-3"></a><span class="co">## </span></span>
<span id="cb666-4"><a href="kriging.html#cb666-4"></a><span class="co">##  Pearson&#39;s product-moment correlation</span></span>
<span id="cb666-5"><a href="kriging.html#cb666-5"></a><span class="co">## </span></span>
<span id="cb666-6"><a href="kriging.html#cb666-6"></a><span class="co">## data:  sterr and var1.pred</span></span>
<span id="cb666-7"><a href="kriging.html#cb666-7"></a><span class="co">## t = -0.084465, df = 253, p-value = 0.9328</span></span>
<span id="cb666-8"><a href="kriging.html#cb666-8"></a><span class="co">## alternative hypothesis: true correlation is not equal to 0</span></span>
<span id="cb666-9"><a href="kriging.html#cb666-9"></a><span class="co">## 95 percent confidence interval:</span></span>
<span id="cb666-10"><a href="kriging.html#cb666-10"></a><span class="co">##  -0.1280692  0.1176091</span></span>
<span id="cb666-11"><a href="kriging.html#cb666-11"></a><span class="co">## sample estimates:</span></span>
<span id="cb666-12"><a href="kriging.html#cb666-12"></a><span class="co">##          cor </span></span>
<span id="cb666-13"><a href="kriging.html#cb666-13"></a><span class="co">## -0.005310204</span></span></code></pre></div>
<p>Облако рассеяния оценки относительно истинных значений должно быть компактным:</p>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="kriging.html#cb667-1"></a><span class="kw">ggplot</span>(cvl, <span class="kw">aes</span>(<span class="dt">x =</span> var1.pred, observed)) <span class="op">+</span></span>
<span id="cb667-2"><a href="kriging.html#cb667-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span></span>
<span id="cb667-3"><a href="kriging.html#cb667-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>) <span class="op">+</span></span>
<span id="cb667-4"><a href="kriging.html#cb667-4"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-627-1.png" width="2100" /></p>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="kriging.html#cb668-1"></a></span>
<span id="cb668-2"><a href="kriging.html#cb668-2"></a><span class="co"># Диагностика модели линейной регрессии</span></span>
<span id="cb668-3"><a href="kriging.html#cb668-3"></a><span class="kw">summary</span>(<span class="kw">lm</span>(observed <span class="op">~</span><span class="st"> </span>var1.pred, cvl))</span>
<span id="cb668-4"><a href="kriging.html#cb668-4"></a><span class="co">## </span></span>
<span id="cb668-5"><a href="kriging.html#cb668-5"></a><span class="co">## Call:</span></span>
<span id="cb668-6"><a href="kriging.html#cb668-6"></a><span class="co">## lm(formula = observed ~ var1.pred, data = cvl)</span></span>
<span id="cb668-7"><a href="kriging.html#cb668-7"></a><span class="co">## </span></span>
<span id="cb668-8"><a href="kriging.html#cb668-8"></a><span class="co">## Residuals:</span></span>
<span id="cb668-9"><a href="kriging.html#cb668-9"></a><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span id="cb668-10"><a href="kriging.html#cb668-10"></a><span class="co">## -47.812  -3.914  -0.505   3.227  32.685 </span></span>
<span id="cb668-11"><a href="kriging.html#cb668-11"></a><span class="co">## </span></span>
<span id="cb668-12"><a href="kriging.html#cb668-12"></a><span class="co">## Coefficients:</span></span>
<span id="cb668-13"><a href="kriging.html#cb668-13"></a><span class="co">##             Estimate Std. Error t value            Pr(&gt;|t|)    </span></span>
<span id="cb668-14"><a href="kriging.html#cb668-14"></a><span class="co">## (Intercept) -0.03375    0.93884  -0.036               0.971    </span></span>
<span id="cb668-15"><a href="kriging.html#cb668-15"></a><span class="co">## var1.pred    1.00020    0.03919  25.519 &lt;0.0000000000000002 ***</span></span>
<span id="cb668-16"><a href="kriging.html#cb668-16"></a><span class="co">## ---</span></span>
<span id="cb668-17"><a href="kriging.html#cb668-17"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb668-18"><a href="kriging.html#cb668-18"></a><span class="co">## </span></span>
<span id="cb668-19"><a href="kriging.html#cb668-19"></a><span class="co">## Residual standard error: 8.405 on 253 degrees of freedom</span></span>
<span id="cb668-20"><a href="kriging.html#cb668-20"></a><span class="co">## Multiple R-squared:  0.7202, Adjusted R-squared:  0.7191 </span></span>
<span id="cb668-21"><a href="kriging.html#cb668-21"></a><span class="co">## F-statistic: 651.2 on 1 and 253 DF,  p-value: &lt; 0.00000000000000022</span></span></code></pre></div>
<p>Пространственная картина стандартизированных ошибок должна быть гомогенной:</p>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="kriging.html#cb669-1"></a><span class="kw">library</span>(akima)</span>
<span id="cb669-2"><a href="kriging.html#cb669-2"></a></span>
<span id="cb669-3"><a href="kriging.html#cb669-3"></a>coords =<span class="st"> </span><span class="kw">st_coordinates</span>(rainfall)</span>
<span id="cb669-4"><a href="kriging.html#cb669-4"></a>coords_grid =<span class="st"> </span><span class="kw">st_coordinates</span>(px_grid)</span>
<span id="cb669-5"><a href="kriging.html#cb669-5"></a></span>
<span id="cb669-6"><a href="kriging.html#cb669-6"></a>px_grid =<span class="st"> </span>px_grid <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb669-7"><a href="kriging.html#cb669-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sterr =</span> <span class="kw">interpp</span>(<span class="dt">x =</span> coords[,<span class="dv">1</span>],</span>
<span id="cb669-8"><a href="kriging.html#cb669-8"></a>                         <span class="dt">y =</span> coords[,<span class="dv">2</span>],</span>
<span id="cb669-9"><a href="kriging.html#cb669-9"></a>                         <span class="dt">z =</span> cvl<span class="op">$</span>sterr, </span>
<span id="cb669-10"><a href="kriging.html#cb669-10"></a>                         <span class="dt">xo =</span> coords_grid[,<span class="dv">1</span>],</span>
<span id="cb669-11"><a href="kriging.html#cb669-11"></a>                         <span class="dt">yo =</span> coords_grid[,<span class="dv">2</span>],</span>
<span id="cb669-12"><a href="kriging.html#cb669-12"></a>                         <span class="dt">linear =</span> <span class="ot">FALSE</span>,</span>
<span id="cb669-13"><a href="kriging.html#cb669-13"></a>                         <span class="dt">extrap =</span> <span class="ot">TRUE</span>)<span class="op">$</span>z)</span>
<span id="cb669-14"><a href="kriging.html#cb669-14"></a></span>
<span id="cb669-15"><a href="kriging.html#cb669-15"></a>sterr_levels =<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">2</span>)</span>
<span id="cb669-16"><a href="kriging.html#cb669-16"></a>sterr_ncolors =<span class="st"> </span><span class="kw">length</span>(sterr_levels)<span class="op">-</span><span class="dv">1</span></span>
<span id="cb669-17"><a href="kriging.html#cb669-17"></a>sterr_colors =<span class="st"> </span><span class="kw">colorRampPalette</span>(<span class="kw">c</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;white&#39;</span>, <span class="st">&#39;red&#39;</span>))</span>
<span id="cb669-18"><a href="kriging.html#cb669-18"></a></span>
<span id="cb669-19"><a href="kriging.html#cb669-19"></a>sterrcont =<span class="st"> </span><span class="kw">st_contour</span>(px_grid[<span class="st">&#39;sterr&#39;</span>], <span class="dt">breaks =</span> sterr_levels, <span class="dt">contour_lines =</span> <span class="ot">TRUE</span>)</span>
<span id="cb669-20"><a href="kriging.html#cb669-20"></a></span>
<span id="cb669-21"><a href="kriging.html#cb669-21"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb669-22"><a href="kriging.html#cb669-22"></a><span class="st">  </span><span class="kw">geom_stars</span>(<span class="dt">data =</span> <span class="kw">cut</span>(px_grid[<span class="st">&#39;sterr&#39;</span>], <span class="dt">breaks =</span> sterr_levels)) <span class="op">+</span></span>
<span id="cb669-23"><a href="kriging.html#cb669-23"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">name =</span> <span class="st">&#39;мм&#39;</span>,</span>
<span id="cb669-24"><a href="kriging.html#cb669-24"></a>                    <span class="dt">values =</span> <span class="kw">sterr_colors</span>(sterr_ncolors),</span>
<span id="cb669-25"><a href="kriging.html#cb669-25"></a>                    <span class="dt">labels =</span> <span class="kw">paste</span>(sterr_levels[<span class="op">-</span>sterr_ncolors<span class="dv">-1</span>], <span class="st">&#39;-&#39;</span>, sterr_levels[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb669-26"><a href="kriging.html#cb669-26"></a>                    <span class="dt">drop =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb669-27"><a href="kriging.html#cb669-27"></a><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">crs =</span> <span class="kw">st_crs</span>(rainfall)) <span class="op">+</span></span>
<span id="cb669-28"><a href="kriging.html#cb669-28"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> sterrcont, <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size =</span> <span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb669-29"><a href="kriging.html#cb669-29"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> rainfall, <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">size =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb669-30"><a href="kriging.html#cb669-30"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="r-geo-course_files/figure-html/unnamed-chunk-628-1.png" width="2100" /></p>
</div>
</div>
<div id="geostat_review" class="section level2">
<h2><span class="header-section-number">14.5</span> Краткий обзор</h2>
<p>Для просмотра презентации щелкните на ней один раз левой кнопкой мыши и листайте, используя кнопки на клавиатуре:
<iframe src="https://tsamsonov.github.io/r-geo-course/slides/14-Geostatistics_slides.html#1" width="672" height="500px"></iframe></p>
<blockquote>
<p>Презентацию можно открыть в отдельном окне или вкладке браузере. Для этого щелкните по ней правой кнопкой мыши и выберите соответствующую команду.</p>
</blockquote>
</div>
<div id="geostat_qt" class="section level2">
<h2><span class="header-section-number">14.6</span> Контрольные вопросы и упражнения</h2>
<div id="geostat_q" class="section level3">
<h3><span class="header-section-number">14.6.1</span> Вопросы</h3>
<ol style="list-style-type: decimal">
<li>Дайте определения случайной величины, случайного процесса, сечения случайного процесса, реализации случайного процесса. Проиллюстрируйте их примерами.</li>
<li>Сформулируйте определение основных моментов пространственного случайного процесса: математического ожидания, дисперсии и ковариации. Поясните суть этих понятий на конкретных примерах.</li>
<li>Дайте определение стационарности в строгом смысле слова и стационарности второго порядка.</li>
<li>При каком условии случайная функция является изотропной?</li>
<li>Что такое эргодичность? Пояснить суть этого свойства на наглядном примере.</li>
<li>Сформулируйте суть кригинга как метода интерполяции данных. В чем его сходства и отличия в сравнении с методом радиальных базисных функций?</li>
<li>Что из себя представляет среднеквадратическая ошибка, минимизируемая в методе кригинга?</li>
<li>Почему среднеквадратическую ошибку можно считать равной дисперсии в методе простого кригинга?</li>
<li>Что характеризует дисперсия кригинга?</li>
<li>Напишите систему уравнений простого кригинга и выражение для дисперсии простого кригинга.</li>
<li>Дайте определение стационарности приращений. С какой целью вводится данный тип стационарных процессов?</li>
<li>Какие условия должны быть выполнены для того чтобы ковариацию можно было заменить вариограммой в уравнениях кригинга?</li>
<li>Напишите систему уравнений обычного кригинга и выражение для дисперсии обычного кригинга. Чем эти уравнения отличаются от уравнений простого кригинга?</li>
<li>Изложите модель универсального кригинга в математической и словесной форме.</li>
<li>Что такое базисные функции и ковариаты? Какую роль они выполняют в методе универсального кригинга?</li>
<li>Сформулируйте условия универсальности, от которых ведет свое название метод универсального кригинга.</li>
<li>Напишите систему уравнений универсального кригинга и выражение для дисперсии универсального кригинга.</li>
<li>Перечислите стандартный набор действий, применяемых в рамках выполнения процедуры кросс-валидации результатов кригинга.</li>
<li>Что такое вариограмма? Дайте математическое и словесное определение.</li>
<li>Перечислите свойства вариограммы.</li>
<li>Назовите основные модели вариограммы. Какая модель свидетельствует о наличии пространственного тренда в данных?</li>
<li>Чем эмпирическая вариаограмма отличается от теоретической (модели)?</li>
<li>Сформулируйте принципы построения и назначение основных диагностических графиков вариографии: диаграммы рассеяния с лагом, вариограммного облака, эмпирической вариограммы, вариокарты.</li>
<li>Объясните, каким образом можно получить приближение (подгонку) теоретической модели вариограммы под эмпирические данные.</li>
<li>Расскажите об основных возможностях пакета <strong>gstat</strong>. Перечислите функции этого пакета, которые используются для вариографии и интерполяции методом кригинга.</li>
</ol>
</div>
<div id="geostat_t" class="section level3">
<h3><span class="header-section-number">14.6.2</span> Упражнения</h3>
<ol style="list-style-type: decimal">
<li><p>Загрузите <a href="https://raw.githubusercontent.com/tsamsonov/r-geo-course/master/data/argo.csv">данные</a> дрейфующих буев <a href="http://www.argo.ucsd.edu/About_Argo.html"><strong>ARGO</strong></a> на акваторию Северной Атлантики за 30 января 2010 года. Постройте поля распределения солености и температуры методом обычного кригинга с размером ячейки 50 км. Подберите подходящую модель вариограммы. Выполните визуализацию оценки кригинга и дисперсии кригинга средствами <strong>ggplot2</strong>. Произведите кросс-валидацию полученных результатов.</p>
<blockquote>
<p><strong>Подсказка:</strong> перед построением сетки интерполяции странсформируйте данные в проекцию <a href="http://spatialreference.org/ref/epsg/wgs-84-world-mercator/"><strong>Меркатора</strong></a>. Чтобы полученное поле распределения покрывало только акваторию, маскируйте полученный растр с использованием слоя <em>ocean</em> из набора данных <strong>Natural Earth</strong>. Перед выполнением маскирования преобразуйте мультиполигон в обычные полигоны (в противном случае маскирование отработает некорректно).</p>
</blockquote></li>
</ol>
<table>
<tbody>
<tr class="odd">
<td><em>Самсонов Т.Е.</em> <strong>Визуализация и анализ географических данных на языке R.</strong> М.: Географический факультет МГУ, 2020. DOI: <a href="https://doi.org/10.5281/zenodo.901911">10.5281/zenodo.901911</a></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="interpolation-deterministic.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="autocorrelation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"edit": "https://github.com/tsamsonov/r-geo-course/edit/master/%s"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
